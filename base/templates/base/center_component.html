{% load humanize %}
{% load mathfilters %}


<script>
  $(function () {
    $(".fold-table tr.view").on("click", function () {
      if ($(this).hasClass("open")) {
        $(this).removeClass("open").next(".fold").removeClass("open");
      } else {
        $(".fold-table tr.view").removeClass("open").next(".fold").removeClass("open");
        $(this).addClass("open").next(".fold").addClass("open");
      }
    });
  });

</script>

<script>
  $(document).ready(function () {

    $('ul.tabs li').click(function () {
      var tab_id = $(this).attr('data-tab');

      $('ul.tabs li').removeClass('current');
      $('.tab-content').removeClass('current');

      $(this).addClass('current');
      $("#" + tab_id).addClass('current');
    })

  })
</script>

<div>

  <ul class="tabs">
    <li class="tab-link current" data-tab="tab-1">ÏÑúÏö∏</li>
    <li class="tab-link" data-tab="tab-2">Î∂ÄÏÇ∞</li>
    <li class="tab-link" data-tab="tab-3">ÏÑ∏Î≤àÏß∏ Î©îÎâ¥</li>
  </ul>

  <div id="tab-1" class="tab-content current">

    <table class="rwd-table">
      
        <tr>
          <th colspan="2" rowspan="2" align="center" style="font-size:1.3rem; padding: 1.0em; text-transform:capitalize; border-right: 1px solid gray;">Race<br>No.</th>
          <th colspan="5" rowspan="1" align="center" style="font-size:1.3rem; padding: 1.0em; text-transform:capitalize;">
            {{race.0.1|slice:"0:4"}}.{{race.0.1|slice:"4:6"}}.{{race.0.1|slice:"6:8"}}&nbsp; ({{race.0.2}})
          </th>
          <th colspan="18" align="center" style="font-size:1.3rem; padding: 1.0em;">
            Program Expected Ranking (Î∂ÄÎã¥Ï§ëÎüâ Ï¶ùÍ∞ê : ‚äñ üü• ‚úö üü¶)</th>
          <th></th>
        </tr>
        <tr>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R1</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R2</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R3</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R4</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R5</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R6</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R7</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R8</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R9</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R10</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">R11</th>
          <th colspan="2" align="center" style="font-size:1.3rem; padding: 0.7em;">r12</th>
        </tr>
     
     
        {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance in race %}
    
        <tr>
          
          <td>
            <div style="font-size:1.0rem; text-align:left; font-weight: 550; color:var(--color-main);">{% if r_rno == 1 %}{{r_rcity}}{% endif %}</div>
            <div style="text-align: right; font-family: Arial; font-size: 1.4rem; font-weight: 550; color:var(--color-main-light);">{{r_rno}}·¥ø&nbsp;</div>
          </td>
    
          <td align="right" style="border-right: 1px solid gray;">
    
            
            <div style="font-family: Arial; font-size: x-small; text-align: right; color: var(--color-main-light);">{{distance}}</div>
            <div style="font-size:x-small; text-align:center; color:var(--color-gray); font-family: Arial;">{{rtime}}</div>
    
          </td>
    
    
          {% for rcity, rdate, rday, rno, gate, rank, r_rank, horse, remark, jockey, trainer, host, r_pop, distance, handycap, i_prehandy, complex, complex5, i_complex, jt_per in expects %}
          {% if r_rcity == rcity and r_rdate == rdate and r_rno == rno %}
    
          <td align="center" style="font-family: Arial; color: var(--color-main); border-style: none;">
    
            {% if jockey|slice:"-2:" == jname1|slice:"-2:" %}
            <div style="font-size:0.2rem; color: var(--color-r1); font-weight: 550;">{{jockey|slice:"-2:"}}</div>
            {% elif jockey|slice:"-2:" == jname2|slice:"-2:" %}
            <div style="font-size:0.2rem; color: var(--color-r2); font-weight: 550;">{{jockey|slice:"-2:"}}</div>
            {% elif jockey|slice:"-2:" == jname3|slice:"-2:" %}
            <div style="font-size:0.2rem; color: var(--color-r3); font-weight: 550;">{{jockey|slice:"-2:"}}</div>
            {% else %}
            <div style="font-size:0.2rem; color: var(--color-gray)">{{jockey|slice:"-2:"}}</div>
            {% endif %}
    
            <div align="center" style="font-size: 1.3rem; padding:0rem ">
              {% if rank == 1 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">
                {{gate}}
              </span>
              {% elif rank == 2 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">
                {{gate}}
              </span>
              {% elif rank == 3 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">
                {{gate}}
              </span>
              {% elif rank == 4 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">
                {{gate}}
              </span>
              {% elif rank == 5 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">
                {{gate}}
              </span>
              {% else %}
              {% if complex == complex5 %}
              <span style="font-family: Arial; font-style: italic; color:var(--color-main-light); font-weight: 550;">{{gate}}</span>
              {% else %}
              <span style="font-family: Arial; font-style: normal; color:var(--color-main);">{{gate}}</span>
              {% endif %}
              {% endif %}
            </div>
    
          </td>

          <td align="center">
    
            {% if handycap|sub:i_prehandy >= 10 %}
            <div style="font-size:x-small;">-</div>
            {% elif handycap|sub:i_prehandy > 0 and handycap|sub:i_prehandy < 10 %} <div style="font-size:x-small; font-family: Arial; color:blue;font-weight: 550;">{{handycap|sub:i_prehandy}}</div>
              {% elif handycap|sub:i_prehandy == 0 %}
              <div style="font-size:x-small;">-</div>
              {% else %}
              <div style="font-size:x-small; font-family: Arial; color:red; font-weight: 550;">{{handycap|sub:i_prehandy|mul:-1}}</div>
              {% endif %}
    
              {% if jt_per >= 50 %}
              <div style="font-size:x-small; font-family: Arial; color:var(--color-r1); font-weight: 400;">{{jt_per}}</div>
              {% elif jt_per >= 30 and jt_per < 50 %} <div style="font-size:x-small; font-family: Arial; color:var(--color-r2); font-weight: 400;">{{jt_per}}</div>
                {% elif jt_per >= 10 and jt_per < 30 %} <div style="font-size:x-small; font-family: Arial; color:var(--color-r5); font-weight: 400;">{{jt_per}}</div>
                  {% else %}
                  <div style="font-size:x-small; font-family: Arial; color:var(--color-gray);">{{jt_per}}</div>
                  {% endif %}

                  <!-- {% if r_pop >= 70 %}
                  <div style="font-size:x-small; font-family: Arial; color:var(--color-r1); font-weight: 550;">{{r_pop}}</div>
                  {% elif r_pop >= 10 and r_pop < 80 %}
                  <div style="font-size:x-small; font-family: Arial; color:var(--color-r2); font-weight: 550;">{{r_pop}}</div>
                  {% elif r_pop >= 1 and r_pop < 10 %}
                  <div style="font-size:x-small; font-family: Arial; color:var(--color-r3); font-weight: 550;">{{r_pop}}</div>
                  {% else %}
                  <div style="font-size:x-small; font-family: Arial; color:var(--color-gray);">{{r_pop}}</div>
                  {% endif %} -->
    
                  {% if rank > 90 %}
                  <div style="font-size:x-small">(Ïã†)</div>
                  {% else %}
                    {% if i_complex == None %}
                    <div style="font-size:x-small">&nbsp;</div>
                    {%else%}
                    {% if i_complex < 10 %} 
                    <div style="font-size:x-small; color: red;  font-weight: 550;">{{i_complex|floatformat:0}}</div>
                    {%else%}
                    <div style="font-size:x-small; color: blue; font-weight: 550;">{{i_complex|floatformat:0}}</div>
                    {%endif%}
                  {% endif %}
                  {% endif %}
          </td>
    
    
          {% endif %}
          {% endfor %}
          
    
        </tr>
        {% endfor %}

        <tr class="fold">
          <td colspan="18">
            <div class="fold-content">
              <table class="small-friendly">
                <thead>
                  <tr>
                    <th><span class="visible-small" title="Current">ÏòàÏÉÅ</span><span class="visible-big">ÏòàÏÉÅ</span></th>
                    <th><span class="visible-small" title="Customer name">ÎßàÎ≤à</span><span class="visible-big">ÎßàÎ≤à</span></th>
                    <th><span class="visible-small" title="Insurance number">Í≤ΩÏ£ºÎßà</span><span class="visible-big">Í≤ΩÏ£ºÎßà</span></th>
                    <th colspan="2"><span class="visible-small" title="Insurance number">Î∂ÄÎã¥Ï§ëÎüâ</span><span class="visible-big">Î∂ÄÎã¥Ï§ëÎüâ</span></th>
                    <th><span class="visible-small" title="Strategy">Í∏∞Ïàò</span><span class="visible-big">Í∏∞Ïàò</span></th>
                    <th><span class="visible-small" title="Strategy">Ï°∞ÍµêÏÇ¨</span><span class="visible-big">Ï°∞ÍµêÏÇ¨</span></th>
                    <th><span class="visible-small" title="Strategy">S1F</span><span class="visible-big">S1F</span></th>
                    <th><span class="visible-small" title="Strategy">G3F</span><span class="visible-big">G3F</span></th>
                    <th><span class="visible-small" title="Strategy">G2F</span><span class="visible-big">G2F</span></th>
                    <th><span class="visible-small" title="Strategy">G1F</span><span class="visible-big">G1F</span></th>
                    <th><span class="visible-small" title="Strategy">ÏòàÏÉÅ</span><span class="visible-big">ÏòàÏÉÅ</span></th>
                    
                    <th><span class="visible-small" title="Current">Ïù∏Í∏∞ÎèÑ</span><span class="visible-big">Ïù∏Í∏∞ÎèÑ</span></th>
                    
                    <th><span class="visible-small" title="Current">Í≤∞Í≥º</span><span class="visible-big">Í≤∞Í≥º</span></th>
                    
                  </tr>
                </thead>
                <tbody>
                  {% for r in raceing %}
                  {% if r.rcity == rcity and r.rdate == rdate and r.rno == rno  %}
                  <tr>
                    <td align="center" data-th="ÏòàÏÉÅ" style="font-size: 1.2rem;">
                      {% if rank == 98 %}Ïã†{%else%}
                        {% if rank == 1 %}
                        <span class="cur" style="color:var(--color-r1); font-weight: 600;">{{rank}}</span>
                        {% elif rank == 2 %}
                        <span class="cur" style="color:var(--color-r2); font-weight: 600;">{{rank}}</span>
                        {% elif rank == 3 %}
                        <span class="cur" style="color:var(--color-r3); font-weight: 600;">{{rank}}</span>
                        {% elif rank == 4 %}
                        <span class="cur" style="color:var(--color-r4); font-weight: 600;">{{rank}}</span>
                        {% elif rank == 5 %}
                        <span class="cur" style="color:var(--color-r5); font-weight: 600;">{{rank}}</span>
                        {% else %}
                        <span class="cur">{{rank}}</span>
                        {%endif%}
                      {%endif%}
                    </td>
                    <td align="center" data-th="Gate" style="font-size: 1.2rem;">
                      {% if rank == 1 %}
                      <span class="cur" style="color:var(--color-r1); font-weight: 600;">{{gate}}</span>
                      {% elif rank == 2 %}
                      <span class="cur" style="color:var(--color-r2); font-weight: 600;">{{gate}}</span>
                      {% elif rank == 3 %}
                      <span class="cur" style="color:var(--color-r3); font-weight: 600;">{{gate}}</span>
                      {% elif rank == 4 %}
                      <span class="cur" style="color:var(--color-r4); font-weight: 600;">{{gate}}</span>
                      {% elif rank == 5 %}
                      <span class="cur" style="color:var(--color-r5); font-weight: 600;">{{gate}}</span>
                      {% else %}
                      <span class="cur">{{gate}}</span>
                      {%endif%}
                    </td>
                    <td td align="left" data-th="Í≤ΩÏ£ºÎßà" style="font-size: 1.2rem;">
                      {% if rank == 1 %}
                      <span class="cur" style="color:var(--color-r1); font-weight: 600;">{{horse|slice:"0:4"}}</span>
                      {% elif rank == 2 %}
                      <span class="cur" style="color:var(--color-r2); font-weight: 600;">{{horse|slice:"0:4"}}</span>
                      {% elif rank == 3 %}
                      <span class="cur" style="color:var(--color-r3); font-weight: 600;">{{horse|slice:"0:4"}}</span>
                      {% elif rank == 4 %}
                      <span class="cur" style="color:var(--color-r4); font-weight: 600;">{{horse|slice:"0:4"}}</span>
                      {% elif rank == 5 %}
                      <span class="cur" style="color:var(--color-r5); font-weight: 600;">{{horse|slice:"0:4"}}</span>
                      {% else %}
                      <span class="cur">{{horse|slice:"0:4"}}</span>
                      {%endif%}
                    </td>

                    <td data-th="Î∂ÄÏ§ë" style="font-size: 1.0rem">{{handycap}}</td>

                    <td data-th="Ï†ÑÍ≤ΩÏ£º ÎåÄÎπÑ Ï∞®" >
                      {% if i_pre > 0 %}
                      <span style="font-size: 1.0rem; color:var(--color-r5);" align="right">+{{i_pre}}</span>
                      {% elif i_pre < 0 %}
                      <span style="font-size: 1.0rem; color:var(--color-r1);" align="right">{{i_pre}}</span>
                      {% else %}
                      <span style="font-size: 1.0rem" align="right">-</span>
                      {% endif %}
                    </td>

                    <td data-th="Í∏∞Ïàò" style="font-size: 1.2rem">{{j_name}}</td>
                    <td data-th="Ï°∞ÍµêÏÇ¨" style="font-size: 1.2rem"><span class="cur">{{t_name}}</span></td>

                    <td data-th="S1F"><span style="font-size: 1.1rem; font-family: Arial">{{cs1f}}</span></td>
                    <td data-th="G3F"><span style="font-size: 1.1rem; font-family: Arial">{{cg3f}}</span></td>
                    <td data-th="G2F"><span style="font-size: 1.1rem; font-family: Arial">{{cg2f}}</span></td>
                    <td data-th="G1F"><span style="font-size: 1.1rem; font-family: Arial">{{cg1f}}</span></td>

                    <td td align="center" data-th="ÏòàÏÉÅÍ∏∞Î°ù" style="font-size: 1.15rem;">
                      {% if rank == 1 %}
                      <span style="color:var(--color-r1); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {% elif rank == 2 %}
                      <span style="color:var(--color-r2); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {% elif rank == 3 %}
                      <span style="color:var(--color-r3); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {% elif rank == 4 %}
                      <span style="color:var(--color-r4); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {% elif rank == 5 %}
                      <span style="color:var(--color-r5); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {% else %}
                      <span style="color:var(--color-gray); font-family: Arial, Helvetica, sans-serif;">{{complex|slice:"0:1"}}&nbsp;{{complex|slice:"1:6"}}</span>
                      {%endif%}
                    </td>

                    <td align="center" data-th="Ïù∏Í∏∞ÎèÑ" style="font-size: 1.2rem">
                      <span style="color:blue">
                        <progress value={{r_pop}} max="100" style="width: 3rem"></progress>
                        <!-- {% if r_pop > 80 %}‚òÖ
                        {% elif r_pop > 60 and r_pop <= 80 %}‚óé
                        {% elif r_pop > 40 and r_pop <= 60 %}‚óã
                        {% elif r_pop > 20 and r_pop <= 20 %}‚ñ≤
                        {% elif r_pop > 0 %}‚Äª
                        {% else %}‚àí
                        {% endif %} -->
                      </span>
                    </td>

                    <td align="center" data-th="Í≤∞Í≥º" style="font-size: 1.2rem">
                      <a href="http://kra.fiveplayer.co.kr/player.php?f={{rdate}}/{% if rcity == 'ÏÑúÏö∏' %}s{%else%}b{% endif %}{{rno}}r"
                        onclick="window.open(this.href, '_blank', 'width=800, height=600, toolbars=no, scrollbars=yes'); return false;">
                      {% if r_rank >= 90 %}-{%else%}
                        {% if r_rank == 1 %}
                        <span class="cur" style="color:var(--color-r1); font-weight: 600;">{{r_rank}}</span>
                        {% elif r_rank == 2 %}
                        <span class="cur" style="color:var(--color-r2); font-weight: 600;">{{r_rank}}</span>
                        {% elif r_rank == 3 %}
                        <span class="cur" style="color:var(--color-r3); font-weight: 600;">{{r_rank}}</span>
                        {% elif r_rank == 4 %}
                        <span class="cur" style="color:var(--color-r4); font-weight: 500;">{{r_rank}}</span>
                        {% elif r_rank == 5 %}
                        <span class="cur" style="color:var(--color-r5); font-weight: 500;">{{r_rank}}</span>
                        {% else %}
                        <span class="cur" style="color:var(--color-gray);">{{r_rank}}</span>
                        {%endif%}
                      {%endif%}
                    </td>
                    
                  </tr>
                  
                  {% endif %}
                  {% endfor %}

                </tbody>
              </table>
            </div>
          </td>
        </tr>
    
 
    </table>

  </div>

  <div id="tab-2" class="tab-content">

    
  </div>

</div>