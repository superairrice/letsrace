<!DOCTYPE html>
{% load static %}
{% load mathfilters %}
{% load humanize %}

{# load my_custom_tags #}


<html lang="en">

<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BFZZL101LZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-BFZZL101LZ');
  </script>
  <!-- End Google tag -->

  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" type="image/x-icon" href="{% static '/images/number-9.png' %}" />
  
  <link rel="stylesheet" href="{% static 'styles/style.css' %}" />
  <link rel="stylesheet" href="{% static 'styles/styles.css' %}" />

  <script src="{% static 'js/script.js' %}"></script>

  <script src="{% static 'js/jquery-3.6.1.js' %}"></script>

  <title>경주분석 '{{r_condition.rdate|slice:"2:4"}}.{{r_condition.rdate|slice:"4:6"}}.{{r_condition.rdate|slice:"6:8"}}&nbsp;({{r_condition.rday}}) {{r_condition.rcity}}&nbsp;&nbsp;{{r_condition.rno}}경주</title>

</head>

{% block content %}

<!-- <main class="create-room layout"> -->
<main class="create-room layout" >
  <!-- <div class="room" style="height: 100.5vh;"> -->
  <div class="container">

    <div class="roomList" style="height: auto;">

      {# Header #}
      {% include 'base/m_header_of_prediction.html' %}

      <hr style="border: solid 1px black;">
      
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_training' r_condition.rcity r_condition.rdate r_condition.rno %}" onclick="window.open(this.href, 'w_training', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">조교현황</a>
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_judged' r_condition.rcity r_condition.rdate r_condition.rno %}" onclick="window.open(this.href, 'w_judged', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">마필병력 & 재결</a>
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_related' r_condition.rcity r_condition.rdate r_condition.rno %}"
        onclick="
                let monitorWidth = 1920; // 특정 모니터의 너비 (예: 1920px)
                let monitorHeight = 1080; // 특정 모니터의 높이 (예: 1080px)
                let monitorOffset = 1920; // 첫 번째 모니터 끝에서 두 번째 모니터가 시작하는 위치
                
                let winWidth = 900; // 새 창의 너비
                let winHeight = 1400; // 새 창의 높이
                
                let winLeft =  monitorOffset + (monitorWidth - winWidth); // 두 번째 모니터 우측 정렬
                //let winLeft = 1246; // 좌측 정렬: 모니터 시작 위치
                let winTop = 0; // 상단 고정
                window.open(
                  this.href,
                  'w_related',
                  `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                );
                return false;">기수 & 마방 & 마주</a>
      {% if request.user.username == 'admin' %}
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-r5);" href="{% url 'race_related_info' r_condition.rcity r_condition.rdate r_condition.rno %}" 
                onclick="
                monitorWidth = 1920; // 특정 모니터의 너비 (예: 1920px)
                 monitorHeight = 1080; // 특정 모니터의 높이 (예: 1080px)
                 monitorOffset = 1920; // 첫 번째 모니터 끝에서 두 번째 모니터가 시작하는 위치
                
                 winWidth = 900; // 새 창의 너비
                 winHeight = 1400; // 새 창의 높이
                
                // winLeft =  monitorOffset + (monitorWidth - winWidth); // 두 번째 모니터 우측 정렬
                 winLeft = 1246; // 좌측 정렬: 모니터 시작 위치
                 winTop = 0; // 상단 고정
                window.open(
                  this.href,
                  'w_related_info',
                  `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                );
                return false;">Related Info.
      </a>
      {% endif %}
      <hr style="border: solid 1px black;">

      <table class="fold-table" style="border-radius: 7px;">
        <thead>
          <tr>

            
            {% if alloc.r2alloc %}
            <th rowspan="1"><span>예상</span></th>
            {% else %}
            <th rowspan="2" style="vertical-align: middle;"><div>예상<br>순위</div></th>
            {% endif %}

            <th rowspan="1" valign="center"><span>마번</span></th>

            <th colspan="2">
              <a href="{% url 'status_stable' r_condition.rcity r_condition.rdate r_condition.rno %}"
                onclick="window.open(this.href, 'w_status_stable', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem;">🐴&nbsp;Horse
                  <span class="tooltip-text">🔑&nbsp;마방 경주마 보유현황 </span>
              </a>
            </th>
            <th rowspan="2" style="vertical-align:middle">
              <span class="tooltip" style="font-size:1.2rem; color:var(--color-r5);">🚛
                <span class="tooltip-text" style="font-size:1.1rem; text-align: left;">
                  🚛&nbsp;기수 부담중량
                </span>
              </span>
            </th>

            <th>
              <a href="{% url 'trend_winning_rate' r_condition.rcity r_condition.rdate r_condition.rno 'jockey' '99' %}"
                onclick="window.open(this.href, 'w_trend_jockey', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem;">🏇
                  <span class="tooltip-text">🔑&nbsp;기수 연승율 추이</span>
              </a>
            </th>
            <th rowspan="2"><div>복</div><div>승</div><div>%</div></th>
            <th rowspan="2" style="vertical-align: middle;"><span class="tooltip">J&T<span class="tooltip-text">마방 & 기수 3위내 입상현황</span></span></th>
            <th rowspan="1"><span>s1f</span></th>
            <th rowspan="1"><span>g3f</span></th>
            <th rowspan="1"><span>g2f</span></th>
            <th rowspan="1"><span>g1f</span></th>
            <th rowspan="2" style="vertical-align: middle;">
              {% if request.user.is_authenticated %}
              <a href="{% url 'race_simulation' r_condition.rcity r_condition.rdate r_condition.rno 0 0 %}" onclick="window.open(this.href, 'w_simulation', 'width=900, height=1000, toolbars=no, scrollbars=yes'); return false;">
              <div style="text-transform:lowercase; font-style: italic; font-size:1.1rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;">thethe9</div>
              <div style="text-transform:capitalize; font-style: italic; font-size:0.9rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;color:dodgerblue;">Simulation</div>
              <div style="text-transform:capitalize; font-style: italic; font-size:0.9rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px; text-align: right;">기록차</div>
              </a>
              {% else %}
              <div style="text-transform:lowercase; font-style: italic; font-size:1.1rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;">thethe9</div>
              <div style="text-transform:capitalize; font-style: italic; font-size:0.9rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;color:dodgerblue;">Simulation</div>
              <div style="text-transform:capitalize; font-style: italic; font-size:0.9rem; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px; text-align: right;">기록차</div>
              {% endif %}
            </th>
            <th>
              <span style="font-size: 1.1rem; color:var(--color-r5); font-family: Arial, Helvetica, sans-serif;">{{r_condition.distance}}ᴹ</span>
              <span style="font-size: 1.1rem;">3ᴿ</span>
            </th>
            
            {% if alloc.r2alloc %}
            <th><div>P.&nbsp;환산</div></th>
            {% else %}
            <th rowspan="2" style="vertical-align: middle;"><div>P.&nbsp;환산</div></th>
            {% endif %}

            <th rowspan="2" style="vertical-align: middle;"><span style="font-size: 1.2rem;">최근 7경주<br>순위</span></th>

            {% if alloc.r2alloc %}
            <th><span style="color:var(--color-bg)">단식</span></th>
            {% endif %}
            
          </tr>
          <tr>
            
            {% if alloc.r2alloc %} {# 경주결과가 입력되었으면 #}
            <th rowspan="1"><span style="font-size: 0.9rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 2px 2px;">실순</span></th>
            {% endif %}

            <th rowspan="1"><span style="font-size: 0.9rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">레이팅</span></th>

            <th>
              <a href="{% url 'cycle_winning_rate' r_condition.rcity r_condition.rdate r_condition.rno 'trainer' '99' %}"
                onclick="window.open(this.href, 'w_cycle_winning_rate', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem;">Info.
                  <span class="tooltip-text">🔑&nbsp;마방 출주주기별 연승률</span>
              </a>
            <th rowspan="1">
              <span class="tooltip" style="font-size:1.0rem; color:var(--color-r5);">⚖️
                <span class="tooltip-text" style="font-size:1.1rem;">🐴 마체중 증감</span>
              </span>
            </th>

            <th>
              <a href="{% url 'trend_winning_rate' r_condition.rcity r_condition.rdate r_condition.rno 'trainer' '99' %}"
                onclick="window.open(this.href, 'w_trend_trainer', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem;">🛖
                  <span class="tooltip-text">🔑&nbsp;마방 연승율 추이</span>
              </a>
            </th>

            <th rowspan="1"><span style="font-size: 1.0rem; color:var(--color-r5); ">rank</span></th>
            <th rowspan="1" colspan="3">
              <div style="font-size: 1.2rem; font-family: Arial, Helvetica, sans-serif; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;">
                <span style="font-size: 1.2rem;">등급평균&nbsp;:</span>
                <span class="blink" style="font-size: 1.2rem; color:var(--color-main); font-style: italic;">
                  {{track.0.0|slice:"0:1"}}&nbsp;{{track.0.0|slice:"1:"}}
                </span>
              </div>
            </th>
        
            <th><span style="font-size: 1.2rem;">최근 7ᴿ</span></th>

            {% if alloc.r2alloc %} {# 경주결과가 입력되었으면 #}
            <th>
              <span style="font-size: 1.0rem; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg); color: var(--color-light-gray);">경주기록</span>
            </th>
            {% endif %}

            {% if alloc.r2alloc %}
            <th><span style="color:var(--color-bg)">연식</span></th>
            {% endif %}
            
            
          </tr>
      
        </thead>
        <tbody>
          {% for r in exp011s %}
          <tr class="view">
            
            <td align="center" style="font-family: Arial; font-size: 1.4rem; color: var(--color-main-light);">
              <div style="font-family: Arial;">{% if r.rank > 20 %}<span style="font-size: 1.0rem;">🐣</span>{% else %} {{r.rank}} {% endif %}</div>

              <div style="font-family: Arial; font-size:1.0rem; font-style: italic; color:var(--color-r1); text-align: right;">
              {% if r.r_rank %}
                
                {% if r.r_rank == 1 %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-main-light); text-align: right; padding:2px 4px; border-radius: 7px; background-color: var(--color-r1);">{{r.r_rank}}</span>
                {% elif r.r_rank == 2 %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-light); text-align: right; padding:2px 4px; border-radius: 7px; background-color: var(--color-r2);">{{r.r_rank}}</span>
                {% elif r.r_rank == 3 %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-bg); text-align: right; padding:2px 4px; border-radius: 7px; background-color: var(--color-r3);">{{r.r_rank}}</span>
                {% elif r.r_rank == 4 %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-r4); text-align: right; padding:2px 4px; border-radius: 7px;">{{r.r_rank}}</span>
                {% elif r.r_rank == 5 %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-r5); text-align: right; padding:2px 4px; border-radius: 7px;">{{r.r_rank}}</span>
                {% elif r.r_rank == 99 %}
                <span style="font-family: Arial; font-size:.9rem; color:var(--color-gray); text-align: right; padding:2px 4px; border-radius: 7px;">🚫</span>
                {% else %}
                <span style="font-family: Arial; font-size:1.0rem; color:var(--color-gray); text-align: right; padding:2px 4px; border-radius: 7px;">{{r.r_rank}}</span>
                {% endif %}
                
              {% endif %}
              </div>
            </td>

            {# gate(마번) 레이팅 #}
            <td align="center" style="border-radius: 10px; border: 0.5px solid gray; font-size: 1.4rem;">
              {% if r.r_rank == 99 %}
              <span style="font-style: italic; text-decoration:line-through; color:gray;">{{r.gate}}</span>
              {% else %}
                {% if r.rank == 1 %}
                <span style="font-family: Arial; font-style: italic; color:var(--color-r1);">
                  {{r.gate}}
                </span>
                {% elif r.rank == 2 %}
                <span style="font-family: Arial; font-style: italic; color:var(--color-r2);">
                  {{r.gate}}
                </span>
                {% elif r.rank == 3 %}
                <span style="font-family: Arial; font-style: italic; color:var(--color-r3);">
                  {{r.gate}}
                </span>
                {% elif r.rank == 4 %}
                <span style="font-family: Arial; font-style: italic; color:var(--color-r4);">
                  {{r.gate}}
                </span>
                {% elif r.rank == 5 %}
                <span style="font-family: Arial; font-style: italic; color:var(--color-r5);">
                  {{r.gate}}
                </span>
                {% else %}
                  {% if r.complex == r.complex5 %}
                  <span style="font-family: Arial; font-style: italic; color:var(--color-r5);">{{r.gate}}</span>
                  {% else %}
                  <span style="font-family: Arial; font-style: normal; ">{{r.gate}}</span>
                  {% endif %}
                {% endif %}
              {% endif %}
              
              <div style="font-family: Arial; font-size: 1.0rem; text-align: right; ">

                {% if compare_r.rating__max == r.rating and r.rating != 0 %}
                <span style="font-family: Arial; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">{{r.rating}}</span>
                {% else %}
                <span style="font-family: Arial; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">{{r.rating}}</span>
                {% endif %}
              
              </div>

            </td>

            {# 경주마 이름 출주주기, 산지 성별 나이 #}
            <td>
              
              <div style="font-size: 1.3rem;">
                <!-- <span class="tooltip">
                  <progress value={{r.r_pop}} max="99" style="width: 2.5rem"></progress>
                  <span class="tooltip-text" style="z-index: 9;">
                    <div>📊&nbsp;{{r.horse}}</div>
                    <div style="text-align: right;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;인기도&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{r.r_pop}}</div>
                  </span>
                </span>&nbsp; -->

                {% if request.user.username == 'admin' %}

                <a href="{% url 'write_significant' r.rdate r.horse %}" 
                          onclick="
                                monitorWidth = 1920; // 특정 모니터의 너비 (예: 1920px)
                                monitorHeight = 1080; // 특정 모니터의 높이 (예: 1080px)
                                monitorOffset = 1920; // 첫 번째 모니터 끝에서 두 번째 모니터가 시작하는 위치
                                
                                winWidth = 500; // 새 창의 너비
                                winHeight = 550; // 새 창의 높이
                                
                                winLeft =  monitorOffset + (monitorWidth - winWidth); // 두 번째 모니터 우측 정렬
                                //winLeft = 1246; // 좌측 정렬: 모니터 시작 위치
                                winTop = 0; // 상단 고정
                                window.open(
                                  this.href,
                                  'w_write_significant',
                                  `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                                );
                                return false;">
                  {% for hname, r_etc, r_flag in r_memo %}
                    {% if hname == r.horse %}
                      {% if r_flag %}
                        {% if r_flag != '0'  %}
                        <span class="tooltip" style="font-family: Arial; font-size:1.05rem; color:var(--color-r1); padding: 0px 0px;">📕
                          <span class="tooltip-text" style="text-align: left; font-size: 1.2rem; color:var(--color-bg); background-color: var(--color-light); width:30rem; z-index: 9;">&nbsp;&nbsp;&nbsp;&nbsp;📕&nbsp;&nbsp;{{r_etc}}</span>
                        </span>
                        {% else %}
                        <span class="tooltip" style="font-family: Arial; font-size:1.05rem; color:var(--color-r1); padding: 0px 0px;">📘
                          <span class="tooltip-text" style="text-align: left; font-size: 1.2rem; color:var(--color-bg); background-color: var(--color-light); width:30rem; z-index: 9;">&nbsp;&nbsp;&nbsp;&nbsp;📘&nbsp;&nbsp;{{r_etc}}</span>
                        </span>
                        {% endif %}
                      {% else %}
                        <span style="font-family: Arial; font-size:1.05rem; color:var(--color-gray); padding: 0px 0px;">📓</span>
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                </a>
                {% endif %}
                
                {% if r.r_rank == 99 %}
                  <span style="font-size: 1.25rem; font-style: italic; text-decoration:line-through; color:gray;">{{r.horse|slice:"0:6"}}</span>
                {% else %}
                  {% if r.rank == 1 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r1);">{{r.horse|slice:"0:6"}}</span>
                  {% elif r.rank == 2 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r2);">{{r.horse|slice:"0:6"}}</span>
                  {% elif r.rank == 3 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r3);">{{r.horse|slice:"0:6"}}</span>
                  {% elif r.rank == 4 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r4);">{{r.horse|slice:"0:6"}}</span>
                  {% elif r.rank == 5 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r5);">{{r.horse|slice:"0:6"}}</span>
                  {%else%}
                    {% if r.complex == r.complex5 %}
                    <span style="font-size: 1.25rem; font-style: italic; color:var(--color-r5);">{{r.horse|slice:"0:6"}}</span>
                      
                    {% else %}
                      <span style="font-size: 1.25rem; font-style: normal;">{{r.horse|slice:"0:6"}}</span>
                    {% endif %}
                  {%endif%}
                {% endif %}

              </div>

              <div align="right" style="font-size: 1.235rem; color:var(--color-gray);">

                {# 출주주기 #}
                {% if r.r_rank == 99 %}
                <span style="font-size: 1.15rem;">&nbsp;</span>
                <span style="font-size:0.9rem; color:gray;">{% if r.reason %}{{r.reason|slice:"0:8"}}{% endif %}
                </span>
                {% else %}

                  {% if r.rank >= 20 %}
                  <span style="font-size: 1.15rem;">&nbsp;</span>
                  {% else %}
                    {% if r.i_cycle <= 16 %}
                    <span class="blink" style="font-family: Arial; font-size:1.15rem; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding:2px 4px;">{{r.i_cycle|div:7|floatformat:0}}<sup style="font-size:0.7rem;">주</sup></span>
                    
                    {% elif r.i_cycle >= 68 %}
                    <span class="blink" style="font-family: Arial; font-size:1.15rem; color:var(--color-r2); border-radius: 10px; background-color:var(--color-bg); padding:2px 4px;">{{r.i_cycle|div:7|floatformat:0}}<sup style="font-size:0.7rem;">주</sup></span>
                    {% else %}
                    <span style="font-family: Arial; font-size:1.15rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-dark); padding:2px 4px;">{{r.i_cycle|div:7|floatformat:0}}<sup style="font-size:0.7rem;">주</sup></span>
                    {% endif %}
                  {% endif %}

                  {# 출생지 #}
                  {% if r.birthplace == '한' %}
                  <span style="font-size: 1.15rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                  {% elif r.birthplace == '미' %}
                  <span style="font-size: 1.15rem; color:var(--color-r2); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                  {%else%}
                    {% if '포' in r.birthplace %}
                    <span style="font-size: 1.15rem; color:var(--color-r4); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">포</span>
                    {% else %}
                    <span style="font-size: 1.15rem; color:var(--color-r4); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                    {% endif %}
                  {%endif%}
                  
                  {# 성별 #}
                  {% if r.h_sex == '암' %}
                  <span style="font-size: 1.15rem; color:var(--color-r5); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {% elif r.h_sex == '거' %}
                  <span style="font-size: 1.15rem; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {%else%}
                  <span style="font-size: 1.15rem; color:var(--color-light-gray); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {%endif%}
                  
                  {# 나이 #}
                  {% if r.h_age >= 5.9 %}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {% elif r.h_age < 3 %}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-r2); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {%else%}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {%endif%}

                {% endif %}
              </div>
              
            </td>

            {# 마체중 #}
            <td style="font-family: Arial; font-size: 1.2rem;">
              
              <div style="text-align:center">

                {# 경주마 체중 증감 #}

                  {% if r.h_weight|slice:"0:3" <= '440' %}
                  <span style="padding:2px 2px; font-family: Arial; color:var(--color-r5);">{{r.h_weight|slice:"0:3"}}<sup style="font-size: 0.9rem; font-style: italic;">㎏</sup></span>
                  {% elif r.h_weight|slice:"0:3" >= '500' %}
                  <span style="padding:2px 2px; font-family: Arial; color:var(--color-r2);">{{r.h_weight|slice:"0:3"}}<sup style="font-size: 0.9rem; font-style: italic;">㎏</sup></span>
                  {% else %}
                  <span style="padding:2px 2px; font-family: Arial; color:var(--color-gray);">{{r.h_weight|slice:"0:3"}}<sup style="font-size: 0.9rem; font-style: italic;">㎏</sup></span>
                  {% endif %}
                
              </div>

              {% if r.h_weight|slice:"4:" %}
                {% if r.h_weight|slice:"4:5" == '+' %}
                <div style="text-align:right; font-style: italic; font-size: 1.1rem;  color:var(--color-r1);">
                  <span style="font-family: Arial; border-radius: 7px; background-color: var(--color-bg); padding:1px 4px;">{{r.h_weight|slice:"4:"}}</span>
                </div>
                {% else %}
                <div style="text-align:right; font-style: italic; font-size: 1.1rem;  color:var(--color-r5);">
                  <span style="font-family: Arial; border-radius: 7px; background-color: var(--color-bg); padding:1px 4px;">{{r.h_weight|slice:"4:"}}</span>
                </div>
                {% endif %}
              {% endif %}

            </td>

            {# 부담중량 #}
            <td style="font-family: Arial; font-size: 1.2rem;">

              <div align="center" style="font-size:1.2rem;">
                {# 부담중량 #}
                {% if r.handycap == compare_r.handycap__max %}
                <span style="padding:2px 2px; font-family: Arial; color:var(--color-r1);">{{r.handycap}}</span>
                {% else %}
                  {% for jname, load_in, tot_1st in loadin %}
                  {% if jname == r.jockey %}
                    {% if r.handycap|floatformat:0 <= load_in|mul:1|floatformat:0 %}
                    <span style="padding:2px 2px; font-family: Arial; font-style:italic; font-size:1.1rem; color:var(--color-r3); border-radius:7px; background-color:var(--color-bg);">{{r.handycap}}</span>
                    {% elif r.handycap|floatformat:0 <= load_in|mul:1|add:1|floatformat:0 %}
                    <span style="padding:2px 2px; font-family: Arial; font-style:italic; font-size:1.1rem; color:var(--color-light-gray); border-radius:7px; background-color:var(--color-bg);">{{r.handycap}}</span>
                    {% else %}
                    <span style="padding:2px 2px; font-family: Arial; color:var(--color-gray);">{{r.handycap}}</span>
                    {% endif %}
                  {% endif %}
                  {% endfor %}
                {% endif %}
              </div>

              <div style="text-align: right; font-size: 1.2rem;">
                {# 부담중량 증감 #}
                {% if r.i_prehandy == 0.0 %}
                  <span style="font-family: Arial; font-style: italic; font-size: 1.0rem; color: var(--color-gray); text-align: right;">신마</span>
                {% else %}
                  {% if r.handycap|sub:r.i_prehandy == 0 %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-gray); text-align: right;">&nbsp;</span>
                  {% elif r.handycap|sub:r.i_prehandy > 0 and r.handycap|sub:r.i_prehandy <= 1 %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-r2); text-align: right;">+{{r.handycap|sub:r.i_prehandy}}</span>
                  {% elif r.handycap|sub:r.i_prehandy < 0 and r.handycap|sub:r.i_prehandy >= -1 %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-r4); text-align: right;">{{r.handycap|sub:r.i_prehandy}}</span>
                  {% elif r.handycap|sub:r.i_prehandy > 1 %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-r1); text-align: right; padding:2px; border-radius: 7px; background-color: var(--color-bg);">+{{r.handycap|sub:r.i_prehandy}}</span>
                  {% elif r.handycap|sub:r.i_prehandy < -1 %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-r5); text-align: right; padding:2px; border-radius: 7px; background-color: var(--color-bg);">{{r.handycap|sub:r.i_prehandy}}</span>
                  {% else %}
                    <span style="font-family: Arial; font-style: italic; font-size: 1.1rem; color: var(--color-r5); text-align: right;">{{r.handycap|sub:r.i_prehandy}}</span>
                  
                  {% endif %}
                {% endif %}
              </div>
              
            </td>

            {# 기수 조교사 #}
            <td align="center">
              <div style="font-size: 1.2rem; text-align: left; ">
                <span style="color:var(--color-r2); font-size:0.9rem">
                </span>
                {% if r.jockey_old %}   {# 기수변경 #}
                  <span class="tooltip" style="font-style: italic; color:var(--color-r2);">{{r.jockey|slice:"0:3"}}
                    <span class="tooltip-text" style="z-index: 9;">
                      🐴 변경사유 : {{r.reason}}{% if r.jockey_old %}
                      <br>
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;변경전 기수 : <span style="color:var(--color-r2); background-color:var(--color-light); border-radius: 7px; padding: 2px 4px;">{{r.jockey_old}}</span>{% endif %}
                      
                    </span>
                  </span>
                  
                {% else %}
                  <span class="tooltip" style="color:var(--color-light-gray);">{{r.jockey|slice:"0:3"}}

                  </span>
                {%endif %}

                {% for jockey, cnt in training_cnt %}
                  {% if r.jockey == jockey %}
                  <span style="font-family: Arial; font-size: 1.1rem; text-align: right; color:var(--color-r1); border-radius: 7px; background-color: var(--color-bg); padding:2px 4px;">{{cnt}}</span>
                  {% endif %}
                {% endfor %}
                
              </div>
              
              {% if r.trainer in trainer_double_check %}
              <div style="font-size: 1.2rem; text-align: right; color:var(--color-r3)">
                {% for hname, max_date, cnt in disease %}
                  {% if r.horse == hname %}
                  <span style="font-family: Arial; font-size: 1.1rem; color:var(--color-r5); border-radius: 10px; background-color: var(--color-bg); padding:2px 4px;">{{cnt}}</span>
                  {% endif %}
                {% endfor %}  
                
                {{r.trainer}}
              </div>
              {% else %}
              <div style="color: var(--color-gray); font-size: 1.2rem; text-align: right;">
                {% for hname, max_date, cnt in disease %}
                  {% if r.horse == hname %}
                  <span style="font-family: Arial; font-size: 1.1rem; color:var(--color-r5); border-radius: 10px; background-color: var(--color-bg); padding:2px 4px;">{{cnt}}</span>
                  {% endif %}
                {% endfor %}  
                {{r.trainer}}
              </div>
              {% endif %}
              
            </td>

            {# 복승률 #}
            <td align="right" style="font-size: 1.3rem ">

              {% if r.jockey_old %}
              <div style="font-family: Arial; font-size: 1.2rem; color:var(--color-r1); text-decoration:line-through;">{{r.j_per}}</div>
              {% else %}
                {% if r.j_per %}
                  {% if compare_r.j_per__max == r.j_per %}
                  <div style="font-family: Arial; font-size: 1.2rem; color:var(--color-r1);">{{r.j_per}}</div>
                  {%else%}
                  <div style="font-family: Arial; font-size: 1.2rem;">{{r.j_per}}</div>
                  {%endif%}
                {% endif %}
              {% endif %}

              {% if r.t_per %}
                {% if compare_r.t_per__max == r.t_per %}
                <div style="color:var(--color-r1); font-family: Arial; font-size: 1.2rem;">{{r.t_per}}</div>
                {%else%}
                <div style="color: var(--color-gray); font-family: Arial; font-size: 1.2rem;">{{r.t_per}}</div>
                {%endif%}
              {% endif %}
            </td>

            {# 기수 조교사 연대율 #}
            {# url "jt_analysis" '%' r_condition.rdate|mul:1|sub:10000 r_condition.rdate r.jockey r.trainer '%' '%' '1' '99' '1' '99' '0' '0' '0' as url_path #}
            <td align="right">

              {% if r.jockey_old %}
                {# 기수가 변경되었으면 기존 기수의 기록을 삭제 #}
                {% if r.jt_cnt %}
                <div style="font-size: 1.2rem;">
                  {% if r.jt_per == 100.0 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r1); text-decoration: line-through;">{{r.jt_per|floatformat:0}}</span> 
                  {% elif r.jt_per >= 50 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r1); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% elif r.jt_per >= 40 and r.jt_per < 50 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r2); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% elif r.jt_per >= 30 and r.jt_per < 40 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r3); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% elif r.jt_per >= 20 and r.jt_per < 30 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r4); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% elif r.jt_per >= 10 and r.jt_per < 20 %} 
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r5); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% else %}
                  <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-gray); text-decoration: line-through;">{{r.jt_per|floatformat:1}}</span>
                  {% endif %}
                </div>
                {% endif %}
                
                {# 기수 조교사 연대 출주 복승 회수 #}
                <div style="font-size: 1.0rem; color:gray; text-align: right;">
                  <!-- <a href={{url_path}}
                    onclick="window.open(this.href, 'jt_analysis', 'width=1350, height=1000, toolbars=no, scrollbars=yes'); return false;"> -->

                    <span class="tooltip" style="font-family: Arial; color:var(--color-light-gray);">
                      <span style="font-family: Arial; color:var(--color-r1);">{{r.jt_1st}}</span>
                      <span style="font-family: Arial; color:var(--color-r2);">{{r.jt_2nd|sub:r.jt_1st}}</span>
                      <span style="font-family: Arial; color:var(--color-r3);">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                      <span class="tooltip-text" style="font-family: Arial; font-size: 1.15rem; z-index:9;">
                        <div style="font-family: Arial; color:var(--color-light); text-align:center;">👥&nbsp; {{r.jockey}}&nbsp;﹆&nbsp;{{r.trainer}}</div>
                        <hr>
                        <div style="font-family: Arial; color:var(--color-main); text-align: left; padding-top: 6px;">1️⃣&nbsp;경주일 기준 최근 1년간 경주성적 : 

                          {% if r.jt_cnt %}
                          <span style="font-family: Arial; color:var(--color-r2); background-color: var(--color-bg); border-radius: 7px; padding: 2px 4px;">{{r.jt_cnt}}</span>
                          <span style="font-family: Arial; color:var(--color-r3)">{{r.jt_1st}}</span>
                          <span style="font-family: Arial; color:var(--color-r4)">{{r.jt_2nd|sub:r.jt_1st}}</span>
                          <span style="font-family: Arial; color:var(--color-r5)">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                          {% else %}
                          <span style="font-family: Arial; color:var(--color-r2); background-color: var(--color-bg); border-radius: 7px; padding: 2px 4px;">0</span>
                          <span style="font-family: Arial; color:var(--color-r3)">0</span>
                          <span style="font-family: Arial; color:var(--color-r4)">0</span>
                          <span style="font-family: Arial; color:var(--color-r5)">0</span>
                          {% endif %}
                        </div>
                        <div style="font-family: Arial; color:var(--color-light-gray); text-align: left;">
                          2️⃣&nbsp;복승률 : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          {% if r.jt_cnt > 0 %}
                          <span style="font-family: Arial; color: var(--color-r2);">{{r.jt_2nd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                          {% else %}
                          <span style="font-family: Arial; color: var(--color-light-gray);">0.0</span>
                          {% endif %}
                        </div>
                        <div style="font-family: Arial; color:var(--color-light-gray); text-align: left;">
                          3️⃣&nbsp;연승률 : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          {% if r.jt_cnt > 0 %}
                          <span style="font-family: Arial; color: var(--color-r1);">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                          {% else %}
                          <span style="font-family: Arial; color: var(--color-light-gray);">0.0</span>
                          {% endif %}
                        </div>
                  
                      </span>
                    </span>

                  <!-- </a> -->
                </div>
              {% else %}
                {% if r.jt_cnt %}
                  <div style="font-size: 1.2rem;">
                    {% if r.jt_per == 100.0 %} 
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 5px;">{{r.jt_per|floatformat:0}}</span> 
                      {% elif r.jt_per >= 50 %} 
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 5px;">{{r.jt_per|floatformat:1}}</span>
                      {% elif r.jt_per >= 40 and r.jt_per < 50 %} 
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r2); background-color: var(--color-bg); padding: 2px 4px; border-radius: 5px;">{{r.jt_per|floatformat:1}}</span>
                      {% elif r.jt_per >= 30 and r.jt_per < 40 %} 
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r3); background-color: var(--color-bg); padding: 2px 4px; border-radius: 5px;">{{r.jt_per|floatformat:1}}</span>
                      {% elif r.jt_per >= 20 and r.jt_per < 30 %} 
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-r4);">{{r.jt_per|floatformat:1}}</span>
                      
                      {% else %}
                      <span style="font-family: Arial, Helvetica, sans-serif; color:var(--color-gray);">{{r.jt_per|floatformat:1}}</span>
                      {% endif %}
                  </div>
                {% endif %}
              
                {# 기수 조교사 연대 출주 복승 회수 #}
                <div style="font-size: 1.05rem; color:gray;">
                  {% if r.jt_cnt == 0 %}
                  <span class="tooltip" style="font-family: Arial; color:var(--color-r1); text-align: center;">🅾️
                    <span class="tooltip-text" style="z-index: 9; font-size: 1.1rem;">🅾️&nbsp;최근 1년간 기수 & 조교사 경주&nbsp;🚫</span>
                  </span>
                  <span>&nbsp;&nbsp;&nbsp;</span>
                  {% else %}
                    {% if r.jt_per == 0.0 %}
                    <span class="tooltip" style="font-family: Arial; color:var(--color-r5); border:1px solid orange; border-radius: 5px; padding: 0px 4px;">{{r.jt_cnt}}
                      <span class="tooltip-text" style="z-index: 9; font-size: 1.1rem;">🆕&nbsp;기수 & 조교사 최근 1년 출주 수</span>
                    </span>
                    {% else %}
                    <span class="tooltip" style="font-family: Arial; color:var(--color-light-gray);">
                      <span style="font-family: Arial; color:var(--color-r1);">{{r.jt_1st}}</span>
                      <span style="font-family: Arial; color:var(--color-r2);">{{r.jt_2nd|sub:r.jt_1st}}</span>
                      <span style="font-family: Arial; color:var(--color-r3);">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                      <span class="tooltip-text" style="font-family: Arial; font-size: 1.15rem; z-index:9;">
                        <div style="font-family: Arial; color:var(--color-light); text-align:center;">👥&nbsp; {{r.jockey}}&nbsp;﹆&nbsp;{{r.trainer}}</div>
                        <hr>
                        <div style="font-family: Arial; color:var(--color-main); text-align: left; padding-top: 6px;">1️⃣&nbsp;경주일 기준 최근 1년간 경주성적 : 

                          {% if r.jt_cnt %}
                          <span style="font-family: Arial; color:var(--color-r2); background-color: var(--color-bg); border-radius: 7px; padding: 2px 4px;">{{r.jt_cnt}}</span>
                          <span style="font-family: Arial; color:var(--color-r3)">{{r.jt_1st}}</span>
                          <span style="font-family: Arial; color:var(--color-r4)">{{r.jt_2nd|sub:r.jt_1st}}</span>
                          <span style="font-family: Arial; color:var(--color-r5)">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                          {% else %}
                          <span style="font-family: Arial; color:var(--color-r2); background-color: var(--color-bg); border-radius: 7px; padding: 2px 4px;">0</span>
                          <span style="font-family: Arial; color:var(--color-r3)">0</span>
                          <span style="font-family: Arial; color:var(--color-r4)">0</span>
                          <span style="font-family: Arial; color:var(--color-r5)">0</span>
                          {% endif %}
                        </div>
                        <div style="font-family: Arial; color:var(--color-light-gray); text-align: left;">
                          2️⃣&nbsp;복승률 : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          {% if r.jt_cnt > 0 %}
                          <span style="font-family: Arial; color: var(--color-r2);">{{r.jt_2nd|mul:100|div:r.jt_cnt|floatformat:"1"}}<sup style="color:var(--color-gray); font-size:0.7rem;">%</sup></span>
                          {% else %}
                          <span style="font-family: Arial; color: var(--color-light-gray);">0.0<sup style="color:var(--color-gray); font-size:0.7rem;">%</sup></span>
                          {% endif %}
                        </div>
                        <div style="font-family: Arial; color:var(--color-light-gray); text-align: left;">
                          3️⃣&nbsp;연승률 : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          {% if r.jt_cnt > 0 %}
                          <span style="font-family: Arial; color: var(--color-r1);">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}<sup style="color:var(--color-gray); font-size:0.7rem;">%</sup></span>
                          {% else %}
                          <span style="font-family: Arial; color: var(--color-light-gray);">0.0<sup style="color:var(--color-gray); font-size:0.7rem;">%</sup></span>
                          {% endif %}
                        </div>
                      </span>
                    </span>
                    {% endif %}
                  {% endif %}

                </div>
              {% endif %}
            </td>
            
            {# 경주전개 furlong 기록 #}
            <td align="center" style="font-size: 1.25rem;">
              {% if compare_r.i_s1f__min == r.i_s1f %}
              <span style="font-family: Arial; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 7px;">{{r.cs1f}}</span>
              {% elif r.i_s1f|sub:7 < compare_r.i_s1f__min %}
              <span style="font-family: Arial; color:var(--color-r2);">{{r.cs1f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cs1f}}</span>
              {% endif %}

              {% if r.s1f_rank %}
                {% if compare_r.s1f_rank__min == r.s1f_rank %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-r1);">{{r.s1f_rank}}</div>
                {% else %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-gray);">
                  
                  {% if r.s1f_rank >= 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">{{r.s1f_rank}}</span>
                  {% elif r.s1f_rank >= 3 and r.s1f_rank < 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r2);">{{r.s1f_rank}}</span>
                  {% elif r.s1f_rank > 0 and r.s1f_rank < 3 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r1);">{{r.s1f_rank}}</span>
                  {% else %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">-</span>
                  {% endif %}
                
                </div>
                {% endif %}
                
              {% endif %}

            </td>
            <td align="center" style="font-size: 1.25rem;">
              {% if compare_r.i_g3f__min == r.i_g3f %}
              <span style="font-family: Arial; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 7px;">{{r.cg3f}}</span>
              {% elif r.i_g3f|sub:7 < compare_r.i_g3f__min %}
              <span style="font-family: Arial; color:var(--color-r2);">{{r.cg3f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cg3f}}</span>
              {% endif %}

              {% if r.g3f_rank %}
                {% if compare_r.g3f_rank__min == r.g3f_rank %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-r1);">{{r.g3f_rank}}</div>
                {% else %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-gray);">
                  
                  {% if r.g3f_rank >= 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">{{r.g3f_rank}}</span>
                  {% elif r.g3f_rank >= 3 and r.g3f_rank < 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r2);">{{r.g3f_rank}}</span>
                  {% elif r.g3f_rank > 0 and r.g3f_rank < 3 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r1);">{{r.g3f_rank}}</span>
                  {% else %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">-</span>
                  {% endif %}
                
                </div>
                {% endif %}
                
              {% endif %}

            </td>
            <td align="center" style="font-size: 1.25rem;">
              {% if compare_r.i_g2f__min == r.i_g2f %}
              <span style="font-family: Arial; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 7px;">{{r.cg2f}}</span>
              {% elif r.i_g2f|sub:7 < compare_r.i_g2f__min %} 
              <span style="font-family: Arial; color:var(--color-r2);">{{r.cg2f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cg2f}}</span>
              {% endif %}

              {% if r.g2f_rank %}
                {% if compare_r.g2f_rank__min == r.g2f_rank %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-r1);">{{r.g2f_rank}}</div>
                {% else %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-gray);">
                  
                  {% if r.g2f_rank >= 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">{{r.g2f_rank}}</span>
                  {% elif r.g2f_rank >= 3 and r.g2f_rank < 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r2);">{{r.g2f_rank}}</span>
                  {% elif r.g2f_rank > 0 and r.g2f_rank < 3 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r1);">{{r.g2f_rank}}</span>
                  {% else %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">-</span>
                  {% endif %}
                
                </div>
                {% endif %}
                
              {% endif %}
            </td>
            <td align="center" style="font-size: 1.25rem;">

              {% if compare_r.i_g1f__min == r.i_g1f %}
              <span style="font-family: Arial; color:var(--color-r1); background-color: var(--color-bg); padding: 2px 4px; border-radius: 7px;">{{r.cg1f}}</span>
              {% elif r.i_g1f|sub:7 < compare_r.i_g1f__min %}
              <span style="font-family: Arial; color:var(--color-r2);">{{r.cg1f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-var(--color-dark));">{{r.cg1f}}</span>
              {% endif %}

              {% if r.g1f_rank %}
                {% if compare_r.g1f_rank__min == r.g1f_rank %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-r1);">{{r.g1f_rank}}</div>
                {% else %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-gray);">
                  
                  {% if r.g1f_rank >= 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">{{r.g1f_rank}}</span>
                  {% elif r.g1f_rank >= 3 and r.g1f_rank < 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r2);">{{r.g1f_rank}}</span>
                  {% elif r.g1f_rank > 0 and r.g1f_rank < 3 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r1);">{{r.g1f_rank}}</span>
                  {% else %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">-</span>
                  {% endif %}
                
                </div>
                {% endif %}
                
              {% endif %}

              
            </td>

            {# 프로그램 예상기록 #}
            <!-- <td align="center" style="border-right: 0.2px solid var(--color-dark);"> -->
            <td align="center" style="border-radius: 10px; border: 0.5px solid gray;">
              
              <div style="font-size: 1.0rem; color:var(--color-light-gray); text-align: right;">
                
                  {% if r.rank == 1 %}
                  <span class="visible-big" style="text-transform:capitalize; font-style: italic; font-size:0.9rem; padding:1px 4px; border-radius: 7px;">
                    📌
                  </span>
                  
                  {% else %}
                  <span style="font-family: Arial; border-radius: 5px; background-color: var(--color-bg); padding: 2px 4px; border-radius: 7px;">
                  {% if r.gap > 0 %}{{r.gap}}{% else %}◦{% endif %}
                  </span>
                  {% endif %}
                
              </div>

              <div style=" font-size: 1.25rem ">
                {% if r.rank == 1 %}
                <span style="color:var(--color-r1); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                {% elif r.rank == 2 %}
                <span style="color:var(--color-r2); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                {% elif r.rank == 3 %}
                <span style="color:var(--color-r3); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                {% elif r.rank == 4 %}
                <span style="color:var(--color-r4); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                {% elif r.rank == 5 %}
                <span style="color:var(--color-r5); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                {% else %}
                  {% if r.complex == r.complex5 %}
                    <span style="color:var(--color-r5); font-family: Arial; font-style: italic;">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                  {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.complex|slice:"0:1"}}&nbsp;{{r.complex|slice:"1:6"}}</span>
                  {% endif %}
                {% endif %}
              </div>
              
              
            </td>

            {# 최근 기록 #}
            <td align="center">
              <div style=" font-size: 1.2rem;">
                
                {% if compare_r.recent3__min == r.recent3 %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}&nbsp;&nbsp;</span>
                {% else %}

                  {% if r.recent3 < r.complex5 %}
                  <span style="font-family: Arial; color:greenyellow; font-style: italic;">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}&nbsp;&nbsp;</span>
                  {% else %}
                    {% if r.recent3 < r.convert_r and r.recent3 < r.recent5 %}
                    <span style="font-family: Arial; color: var(--color-light);">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}&nbsp;&nbsp;</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}&nbsp;&nbsp;</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>
              <div style=" font-size: 1.2rem;">

                {% if compare_r.recent5__min == r.recent5 %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">&nbsp;&nbsp;{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                {% else %}
                  {% if r.recent5 < r.complex5 %}
                  <span style="font-family: Arial; color:greenyellow; font-style: italic;">&nbsp;&nbsp;{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                  {% else %}
                    {% if r.recent5 < r.convert_r and r.recent5 < r.recent3 %}
                    <span style="font-family: Arial; color: var(--color-light);">&nbsp;&nbsp;{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">&nbsp;&nbsp;{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>

            </td>

            {# 환산기록 / 경주기록 #}
            <td>
              <div style=" font-size: 1.2rem; text-align: center;">
                {% if compare_r.convert_r__min == r.convert_r %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                {% else %}

                  {% if r.convert_r < r.complex5 %}
                  <span style="font-family: Arial; color:greenyellow; font-style: italic;">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                  {% else %}
                    {% if r.convert_r < r.recent5 and r.convert_r < r.recent3 %}
                    <span style="font-family: Arial; color: var(--color-light);">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>

              {% if r.r_record %}
                <div style=" font-size: 1.15rem; text-align: right;">
                {% if r.r_rank == 1 %}
                <span style="color:var(--color-light); font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-r1);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% elif r.r_rank == 2 %}
                <span style="color:var(--color-light); font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-r2);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% elif r.r_rank == 3 %}
                <span style="color:var(--color-bg); font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-r3);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% elif r.r_rank == 4 %}
                <span style="color:var(--color-r4); font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-dark-medium);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% elif r.r_rank == 5 %}
                <span style="color:var(--color-r5); font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-dark-medium);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% else %}
                <span style="font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-dark-medium); color: var(--color-gray);">{{r.r_record|slice:"0:1"}}&nbsp;{{r.r_record|slice:"1:6"}}</span>
                {% endif %}
                </div>
              {%endif%}
              
            </td>

            {# 최근7경주 #}
            <td align="center" style="font-family: Arial;">
              
              {% if r.remark == '1' %}
              <div style="font-weight: 700; font-size: 1.0rem; color:var(--color-r1);">{{r.remark}}</div>
              {% elif r.remark == '2' %}
              <div style="font-weight: 700; font-size: 1.0rem; color:var(--color-r2);">{{r.remark}}</div>
              {% elif r.remark == '3' %}
              <div style="font-weight: 700; font-size: 1.0rem; color:var(--color-r3);">{{r.remark}}</div>
              {% elif r.remark == '4' %}
              <div style="font-weight: 700; font-size: 1.0rem; color:var(--color-r4);">{{r.remark}}</div>
              {% elif r.remark == '5' %}
              <div style="font-weight: 700; font-size: 1.0rem; color:var(--color-r5);">{{r.remark}}</div>
              {% else %}
                {% if r.remark|slice:"0:1" == '1' and r.remark|slice:"1:2" == '-' %}
                <div style="font-size: 1.0rem; color:var(--color-r1);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% elif r.remark|slice:"0:1" == '2' and r.remark|slice:"1:2" == '-' %}
                <div style="font-size: 1.0rem; color:var(--color-r2);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% elif r.remark|slice:"0:1" == '3' and r.remark|slice:"1:2" == '-' %}
                <div style="font-size: 1.0rem; color:var(--color-r3);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% elif r.remark|slice:"0:1" == '4' and r.remark|slice:"1:2" == '-' %}
                <div style="font-size: 1.0rem; color:var(--color-r4);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% elif r.remark|slice:"0:1" == '5' and r.remark|slice:"1:2" == '-' %}
                <div style="font-size: 1.0rem; color:var(--color-r5);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% else %}
                <div style="font-size: 1.0rem; color:var(--color-gray);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
                {% endif %}
              {% endif %}

            </td>


            {# 메모 or 연식 #}
            {% if r.alloc3r %}

            <td align="right" style="font-family: Arial; font-size: 1.1rem;">
              
              <div style="font-size: 1.1rem; text-align: right; font-style: normal;">
                {% if r.r_rank == 1 %}
                <span style="color:var(--color-r1); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% elif r.r_rank == 2 %}
                <span style="color:var(--color-r2); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% elif r.r_rank == 3 %}
                <span style="color:var(--color-r3); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% elif r.r_rank == 4 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% elif r.r_rank == 5 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% else %}
                <span style="font-family: Arial; color: var(--color-gray);">{% if r.alloc1r %} {{r.alloc1r}} {% endif %}</span>
                {% endif %}
              </div>

              <div style="font-size: 1.1rem; text-align: right; font-style: normal;">
                {% if r.r_rank == 1 %}
                <span style="color:var(--color-r1); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 2 %}
                <span style="color:var(--color-r2); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 3 %}
                <span style="color:var(--color-r3); font-family: Arial; font-style: italic; font-family: Arial; padding:2px 4px; border-radius: 7px; background-color: var(--color-bg);">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 4 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 5 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% else %}
                <span style="font-family: Arial; color: var(--color-gray);">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% endif %}
              </div>
    
            </td>
            {% endif %}


          </tr>

          <tr class="fold">
            <td colspan="17">
              {% include 'base/m_result.html' %}
            </td>
          </tr>
          {% endfor %}
      
      
        </tbody>
      </table>

    </div>
    <!-- Room End -->
  </div>

  {% include 'footer.html' %}

  <script>
    $(function () {
      $(".fold-table tr.view").on("click", function () {
        if ($(this).hasClass("open")) {
          $(this).removeClass("open").next(".fold").removeClass("open");
        } else {
          $(".fold-table tr.view").removeClass("open").next(".fold").removeClass("open");
          $(this).addClass("open").next(".fold").addClass("open");
        }
      });
    });

  </script>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W5HDZ7Z" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

</main>
{% endblock %}