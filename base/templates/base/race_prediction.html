<!DOCTYPE html>
{% load static %}
{% load mathfilters %}
{% load humanize %}

{# load my_custom_tags #}


<html lang="en">

<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BFZZL101LZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-BFZZL101LZ');
  </script>
  <!-- End Google tag -->

  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" type="image/x-icon" href="{% static '/images/number-9.png' %}" />
  
  <link rel="stylesheet" href="{% static 'styles/style.css' %}" />
  <link rel="stylesheet" href="{% static 'styles/styles.css' %}" />

  <script src="{% static 'js/script.js' %}"></script>

  <script src="{% static 'js/jquery-3.6.1.js' %}"></script>

  <title>ê²½ì£¼ë¶„ì„ '{{r_condition.rdate|slice:"2:4"}}.{{r_condition.rdate|slice:"4:6"}}.{{r_condition.rdate|slice:"6:8"}}&nbsp;({{r_condition.rday}}) {{r_condition.rcity}}&nbsp;&nbsp;{{r_condition.rno}}ê²½ì£¼</title>

</head>

{% block content %}

<body class="create-room layout" style="padding-bottom: 5px;" >
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W5HDZ7Z" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <div class="container">

    <div class="roomList" style="height: auto;">

      {# Header #}
      {% include 'base/m_header_of_prediction.html' %}

      <hr style="border: solid 1px black;">
      
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_training' r_condition.rcity r_condition.rdate r_condition.rno %}" onclick="window.open(this.href, 'w_training', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">ì¡°êµí˜„í™©</a>
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_judged' r_condition.rcity r_condition.rdate r_condition.rno %}" onclick="window.open(this.href, 'w_judged', 'width=900, height=880, toolbars=no, scrollbars=yes'); return false;">ë§ˆí•„ë³‘ë ¥ & ì¬ê²°</a>
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark-medium);" href="{% url 'race_related' r_condition.rcity r_condition.rdate r_condition.rno %}"
        onclick="
                let monitorWidth = 1920; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë„ˆë¹„ (ì˜ˆ: 1920px)
                let monitorHeight = 1080; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë†’ì´ (ì˜ˆ: 1080px)
                let monitorOffset = 1920; // ì²« ë²ˆì§¸ ëª¨ë‹ˆí„° ëì—ì„œ ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„°ê°€ ì‹œì‘í•˜ëŠ” ìœ„ì¹˜
                
                let winWidth = 900; // ìƒˆ ì°½ì˜ ë„ˆë¹„
                let winHeight = 1000; // ìƒˆ ì°½ì˜ ë†’ì´
                
                //let winLeft =  monitorOffset + (monitorWidth - winWidth); // ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„° ìš°ì¸¡ ì •ë ¬
                let winLeft = 666; // ì¢Œì¸¡ ì •ë ¬: ëª¨ë‹ˆí„° ì‹œì‘ ìœ„ì¹˜
                let winTop = 0; // ìƒë‹¨ ê³ ì •
                window.open(
                  this.href,
                  'w_related',
                  `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                );
                return false;">ê¸°ìˆ˜ & ë§ˆë°© & ë§ˆì£¼</a>
      {% if request.user.username == 'admin' %}
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-r5);" href="{% url 'race_related_info' r_condition.rcity r_condition.rdate r_condition.rno %}" 
                onclick="
                monitorWidth = 1920; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë„ˆë¹„ (ì˜ˆ: 1920px)
                monitorHeight = 1080; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë†’ì´ (ì˜ˆ: 1080px)
                monitorOffset = 1920; // ì²« ë²ˆì§¸ ëª¨ë‹ˆí„° ëì—ì„œ ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„°ê°€ ì‹œì‘í•˜ëŠ” ìœ„ì¹˜
              
                winWidth = 900; // ìƒˆ ì°½ì˜ ë„ˆë¹„
                winHeight = 1000; // ìƒˆ ì°½ì˜ ë†’ì´
              
                winLeft =  monitorOffset + (monitorWidth - winWidth); // ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„° ìš°ì¸¡ ì •ë ¬
                //winLeft = 1246; // ì¢Œì¸¡ ì •ë ¬: ëª¨ë‹ˆí„° ì‹œì‘ ìœ„ì¹˜
                winTop = 0; // ìƒë‹¨ ê³ ì •
                window.open(
                  this.href,
                  'w_related_info',
                  `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                );
                return false;">Related Info.
      </a>
      {% endif %}
      &nbsp;&nbsp;&nbsp;&nbsp;
      {% if request.user.is_authenticated %}
        <a style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-main);" href="{% url 'mock_audit' r_condition.rcity r_condition.rdate r_condition.rno 0 0 %}" onclick="window.open(this.href, 'w_mock_audit', 'width=900, height=1000, toolbars=no, scrollbars=yes'); return false;">
          <button class="btn btn--link" type="submit" style="font-size: 1.1rem;">âš™ï¸&nbsp;Mock Audit</button>
        </a>
        &nbsp;&nbsp;
        <a href="#" 
          style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-main);" 
          onclick="runMockAccept('{{ r_condition.rcity }}', '{{ r_condition.rdate }}', '{{ r_condition.rno }}'); return false;">
          <button class="btn btn--link" type="submit" style="font-size: 1.1rem;">ğŸ¤”&nbsp;Accept</button>
        </a>

        <script>
        function runMockAccept(rcity, rdate, rno) {
          // âœ… Ajaxë‚˜ fetchë¡œ ì„œë²„ì˜ íŠ¹ì • í•¨ìˆ˜ë§Œ ì‹¤í–‰
          fetch(`/mock_accept/${rcity}/${rdate}/${rno}`, {
            method: "GET",
          })
          .then(res => res.text())
          .then(data => {
            setTimeout(() => location.reload(), 500);
            console.log("Mock audit result:", data);
            // ì´ ë¶€ë¶„ì—ì„œ UI ì—…ë°ì´íŠ¸ ë“± ì¶”ê°€ ì‘ì—… ê°€ëŠ¥
          })
          .catch(err => console.error(err));
        }
        </script>
      {% endif %}

      &nbsp;&nbsp;&nbsp;&nbsp;
      {% if request.user.username == 'admin' %}
      
      <span style="color: var(--color-main); padding-top: 0.6rem;">
        <a href="#" 
          style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-main);" 
          onclick="runChatGPT('{{ r_condition.rcity }}', '{{ r_condition.rdate }}', '{{ r_condition.rno }}'); return false;">
          <button class="btn btn--link" type="submit" style="font-size: 1.1rem;">ğŸ’¬&nbsp;chatGPT</button>
        </a>

        <script>
        function runChatGPT(rcity, rdate, rno) {
          // âœ… Ajaxë‚˜ fetchë¡œ ì„œë²„ì˜ íŠ¹ì • í•¨ìˆ˜ë§Œ ì‹¤í–‰
          fetch(`/exec_chatGPT/${rcity}/${rdate}/${rno}`, {
            method: "GET",
          })
          .then(res => res.text())
          .then(data => {
            setTimeout(() => location.reload(), 500);
            console.log("Mock audit result:", data);
            // ì´ ë¶€ë¶„ì—ì„œ UI ì—…ë°ì´íŠ¸ ë“± ì¶”ê°€ ì‘ì—… ê°€ëŠ¥
          })
          .catch(err => console.error(err));
        }
        </script>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <span style="color: var(--color-main); padding-top: 0.6rem;">
          <a href="{% url 'race_review' r_condition.rcity r_condition.rdate r_condition.rno %}" 
                    onclick="
                    monitorWidth = 1920; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë„ˆë¹„ (ì˜ˆ: 1920px)
                    monitorHeight = 1080; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë†’ì´ (ì˜ˆ: 1080px)
                    monitorOffset = 1920; // ì²« ë²ˆì§¸ ëª¨ë‹ˆí„° ëì—ì„œ ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„°ê°€ ì‹œì‘í•˜ëŠ” ìœ„ì¹˜
                    
                    winWidth = 900; // ìƒˆ ì°½ì˜ ë„ˆë¹„
                    winHeight = 1000; // ìƒˆ ì°½ì˜ ë†’ì´
                    
                    // winLeft =  monitorOffset + (monitorWidth - winWidth); // ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„° ìš°ì¸¡ ì •ë ¬
                    winLeft = 1246; // ì¢Œì¸¡ ì •ë ¬: ëª¨ë‹ˆí„° ì‹œì‘ ìœ„ì¹˜
                    winTop = 0; // ìƒë‹¨ ê³ ì •
                    window.open(
                      this.href,
                      'w_race_review',
                      `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
                    );
                    return false;">ğŸ”§
              <span style="font-size: 1.35rem;">
            </span>
          </a>
        </span>
      </span>
      {% endif %}
      &nbsp;&nbsp;&nbsp;&nbsp;
      {% if alloc.r2alloc %} {# ê²½ì£¼ê²°ê³¼ê°€ ì…ë ¥ë˜ì—ˆìœ¼ë©´ #}
      <span style="color: var(--color-main); padding-top: 0.6rem;">
        <a href="{% url 'race_result' r_condition.rcity r_condition.rdate r_condition.rno 0 0 0 0 %}"
          onclick="window.open(this.href, 'w_result', 'width=900, height=1000, toolbars=no, scrollbars=yes'); return false;">
          <span class="tooltip" style="font-size: 1.35rem;">ğŸ“ƒ
            <span class="tooltip-text" style="width:11rem; text-align: center;">ğŸ“ƒ&nbsp;Race Result</span>
          </span>
        </a>
      </span>
      {% endif %}
      <hr style="border: solid 1px black;">

      {% include 'base/m_prediction.html' %}

    </div>
    <!-- Room End -->
  </div>
  <!-- {{r_condition.r_guide}} -->
  {% if request.user.is_authenticated %}

  <span style="color: var(--color-main); padding-top: 20px;">
    <a href="{% url 'race_review' r_condition.rcity r_condition.rdate r_condition.rno %}" 
              onclick="
              monitorWidth = 1920; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë„ˆë¹„ (ì˜ˆ: 1920px)
              monitorHeight = 1080; // íŠ¹ì • ëª¨ë‹ˆí„°ì˜ ë†’ì´ (ì˜ˆ: 1080px)
              monitorOffset = 1920; // ì²« ë²ˆì§¸ ëª¨ë‹ˆí„° ëì—ì„œ ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„°ê°€ ì‹œì‘í•˜ëŠ” ìœ„ì¹˜
              
              winWidth = 900; // ìƒˆ ì°½ì˜ ë„ˆë¹„
              winHeight = 1000; // ìƒˆ ì°½ì˜ ë†’ì´
              
              // winLeft =  monitorOffset + (monitorWidth - winWidth); // ë‘ ë²ˆì§¸ ëª¨ë‹ˆí„° ìš°ì¸¡ ì •ë ¬
              winLeft = 1246; // ì¢Œì¸¡ ì •ë ¬: ëª¨ë‹ˆí„° ì‹œì‘ ìœ„ì¹˜
              winTop = 0; // ìƒë‹¨ ê³ ì •
              window.open(
                this.href,
                'w_race_review',
                `width=${winWidth},height=${winHeight},toolbars=no,scrollbars=yes,left=${winLeft},top=${winTop}`
              );
              return false;">ğŸ˜
        <span style="font-size: 1.35rem;">
      </span>
    </a>
  </span>
  <span style="font-size: 1.3rem; color:var(--color-light-gray); padding-top: 20px;">{{r_condition.r_guide|linebreaksbr}}</span>
  <br>
  <span style="font-size: 1.3rem; color:var(--color-r5);">{{r_condition.r_overview|linebreaksbr}}</span>
  {% endif %}

  {% if judged %}
  <div style="font-size: 0.3rem; padding: 2px 6px;">&nbsp;</div>
  <span style="font-size: 1.3rem; padding: 2px 6px;">âš–ï¸&nbsp;ì‹¬íŒìœ„ì› Report</span>

  {% if r_memo.0.3 %}
  <span style="font-size: 1.3rem; padding: 2px 6px; color:var(--color-r5);">[&nbsp;{{r_memo.0.3}}&nbsp;]</span>
  {% endif %}
  
  <div class="form__group">
    <!-- <label for="room_description">ì‹¬íŒìœ„ì› Report</label> -->
    <textarea name="description" cols="400" rows="100" id="id_description" style="font-family:sans-serif; height: 20rem; font-size: 1.35rem; color:var(--color-light-gray); line-height:20px; font-weight: 350;">{{judged}}</textarea>
  </div>
  {% endif %}


  <script>
    $(function () {
      $(".fold-table tr.view").on("click", function () {
        if ($(this).hasClass("open")) {
          $(this).removeClass("open").next(".fold").removeClass("open");
        } else {
          $(".fold-table tr.view").removeClass("open").next(".fold").removeClass("open");
          $(this).addClass("open").next(".fold").addClass("open");
        }
      });
    });

  </script>

  

</body>
{% endblock %}

{% include 'footer.html' %}
</html>
