<!DOCTYPE html>
{% load static %}
{% load mathfilters %}
{% load humanize %}

{% load my_custom_tags %}

<html lang="en">

<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BFZZL101LZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-BFZZL101LZ');
  </script>
  <!-- End Google tag -->

  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" type="image/x-icon" href="{% static '/images/number-9.png' %}" />
  
  <link rel="stylesheet" href="{% static 'styles/style.css' %}" />
  <link rel="stylesheet" href="{% static 'styles/styles.css' %}" />

  <script src="{% static 'js/script.js' %}"></script>

  <script src="{% static 'js/jquery-3.6.1.js' %}"></script>

  <title>출마표 '{{r_condition.rdate|slice:"2:4"}}.{{r_condition.rdate|slice:"4:6"}}.{{r_condition.rdate|slice:"6:8"}}({{r_condition.rday}}) {{r_condition.rcity}}&nbsp;{{r_condition.rno}}ᴿ</title>

</head>

{% block content %}

<main class="profile-page layout layout--2">

  <div class="loader"></div>

  <div class="container">

    {# 출마표 #}
    <div class="roomList" style="height: auto;">
      {# Header #}
      {% include 'base/m_header_of_prediction.html' %}
      
      <hr style="border: solid 1px black;">
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark);"
        href="{% url 'race_training' r_condition.rcity r_condition.rdate r_condition.rno %}"
        onclick="window.open(this.href, 'w_training', 'width=1000, height=880, toolbars=no, scrollbars=yes'); return false;">조교현황</a>
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark);"
        href="{% url 'race_judged' r_condition.rcity r_condition.rdate r_condition.rno %}"
        onclick="window.open(this.href, 'w_judged', 'width=1000, height=880, toolbars=no, scrollbars=yes'); return false;">마필병력 & 재결</a>
      <hr style="border: solid 1px black;">
      
      <table class="fold-table" style="border-radius: 7px;">
        <thead>
          <tr>
            <th rowspan="1" width="6%" valign="center"><span class="visible-big">마번</span></th>

            <th colspan="2"><span class="visible-big">Horse</span></th>
            <th rowspan="2"><span class="visible-big" style="padding:0.95rem">부담<br>중량</span></th>

            <th>
              <a href="{% url 'trend_winning_rate' r_condition.rcity r_condition.rdate r_condition.rno 'jockey' '99' %}"
                onclick="window.open(this.href, 'w_trend_jockey', 'width=1000, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem; font-weight: 400;">기🏇수
                  <span class="tooltip-text">기수 연승율 현황 🔑</span>
              </a>
            </th>
            <th rowspan="2"><span class="visible-big">복<br>승<br>율</span></th>
            <th rowspan="2"><span class="visible-big">조교사<br>&기수<br>연승율</span></th>
            <th rowspan="1"><span class="visible-big">s1f</span></th>
            <th rowspan="1"><span class="visible-big">g3f</span></th>
            <th rowspan="1"><span class="visible-big">g2f</span></th>
            <th rowspan="1"><span class="visible-big">g1f</span></th>
            <th colspan="3">
              <span class="visible-big" style="text-transform:lowercase; font-style: italic; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;">thethe9.com&nbsp;&nbsp;&nbsp;환산기록</span>
            </th>
            
            <th rowspan="2"><span class="visible-big">최근 7경주<br>순위<br>(예외제외)</span></th>

            {% if alloc.r2alloc %}
            <th><span class="visible-big" style="color:var(--color-bg)">연식</span></th>
            {% else %}
            <th rowspan="2"><span class="visible-big">&nbsp;<br>인기도<br>&nbsp;</span></th>
            {% endif %}

            {% if alloc.r2alloc %}
            <th rowspan="1"><span class="visible-big">P.&nbsp;R</span></th>
            {% else %}
            <th rowspan="2"><span class="visible-big">&nbsp;<br>P.&nbsp;R<br>&nbsp;</span></th>
            {% endif %}
            
          </tr>
          <tr>
            
            <th rowspan="1"><span style="font-size: 0.9rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">레이팅</span></th>
            
            <th><span class="visible-big">Info.</span></th>
            <th rowspan="1"><span class="visible-big">체중</span></th>

            <th>
              <a href="{% url 'trend_winning_rate' r_condition.rcity r_condition.rdate r_condition.rno 'trainer' '99' %}"
                onclick="window.open(this.href, 'w_trend_trainer', 'width=1000, height=880, toolbars=no, scrollbars=yes'); return false;">
                <span class="tooltip" style="font-size: 1.2rem; font-weight: 400;">조교사
                  <span class="tooltip-text">조교사 연승율 현황 🔑</span>
              </a>
            </th>

            <th rowspan="1"><span style="font-size: 1.0rem; color:var(--color-r5); ">rank</span></th>
            <th rowspan="1" colspan="3">
              <div style="font-size: 1.2rem; font-family: Arial, Helvetica, sans-serif; background-color: var(--color-bg); padding:1px 4px; border-radius: 7px;">
                <span style="font-size: 1.2rem;">등급평균&nbsp;:</span>
                <span class="blink" style="font-size: 1.2rem; color:var(--color-main); font-style: italic;">
                  {{track.0.0|slice:"0:1"}}&nbsp;{{track.0.0|slice:"1:"}}
                </span>
              </div>
            </th>

            <th>
              <span style="font-size: 1.1rem; color:var(--color-r5); font-family: Arial, Helvetica, sans-serif;">{{r_condition.distance}}ᴹ</span>
              <span style="font-size: 1.3rem;">3ᴿ</span>
            </th>
            <th><span class="visible-big">최근 7ᴿ</span></th>
            <th><span class="visible-big">P.&nbsp;환산</span></th>

            {% if alloc.r2alloc %}
            <th><span class="visible-big" style="color:var(--color-bg)">인기도</span></th>
            {% endif %}

            {% if alloc.r2alloc %} {# 경주결과가 입력되었으면 #}
            <th rowspan="1"><span class="visible-big" style="color:var(--color-bg)">(실순)</span></th>
            {% endif %}
            
          </tr>
      
        </thead>
        <tbody>
          {% for r in exp011s %}
          <tr class="view">
            
            {# gate(마번) / 레이팅 #}
            <td align="center" style="font-size: 1.4rem ">
              {% if r.r_rank == 99 %}
              <span style="font-style: italic; text-decoration:line-through; color:gray;">{{r.gate}}</span>
              {% else %}
                
                <span style="font-family: Arial; font-style: italic; color:var(--color-light); font-weight: 700;">
                  {{r.gate}}
                </span>
                
              {% endif %}

              <div style="font-family: Arial; font-size: 1.1rem; text-align: right; ">
                {% if compare_r.rating__max == r.rating and r.rating != 0 %}
                <span style="font-family: Arial; color:var(--color-r1); font-weight: 700; border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">{{r.rating}}</span>
                {% else %}
                <span style="font-family: Arial; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 2px 4px;">{{r.rating}}</span>
                {% endif %}
              </div>
              
            </td>
            
            {# 경주마 이름 출주주기, 산지 성별 나이 #}
            <td>
              <div style="font-size: 1.3rem;">
                
                {% if r.r_rank == 99 %}
                  <span style="font-style: italic; text-decoration:line-through; color:gray;">{{r.horse}}</span>
                {% else %}
                  <span style="font-style: normal;">{{r.horse}}</span>
                {% endif %}
              </div>
              <div align="right" style="font-size: 1.2rem; color:var(--color-gray);">

                {# 출주주기 #}
                {% if r.r_rank == 99 %}
                <span style="font-size:0.9rem; color:gray;">{% if r.reason %}{{r.reason|slice:"0:8"}}{% endif %}
                </span>
                {% else %}

                  {% if r.rank >= 20 %}
                  <span>주행</span>
                  {% else %}
                    {% if r.i_cycle <= 16 %}
                    <span class="blink" style="font-family: Arial; color:var(--color-r1); font-weight: 500; border-radius: 10px; background-color:var(--color-bg); padding:1px 2px;">{{r.i_cycle|div:7|floatformat:0}}주</span>
                    {% elif r.i_cycle >= 68 %}
                    <span class="blink" style="font-family: Arial; color:var(--color-r2); font-weight: 500; border-radius: 10px; background-color:var(--color-bg); padding:1px 2px;">{{r.i_cycle|div:7|floatformat:0}}주</span>
                    {% else %}
                    <span style="font-family: Arial; color:var(--color-gray); ">{{r.i_cycle|div:7|floatformat:0}}주</span>
                    {% endif %}
                  {% endif %}
                  &nbsp;
                  {# 출생지 #}
                  {% if r.birthplace == '한' %}
                  <span style="font-size: 1.2rem; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                  {% elif r.birthplace == '미' %}
                  <span style="font-size: 1.2rem; color:var(--color-r2); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                  {%else%}
                    {% if '포' in r.birthplace %}
                    <span style="font-size: 1.2rem; color:var(--color-r4); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">포</span>
                    {% else %}
                    <span style="font-size: 1.2rem; color:var(--color-r4); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.birthplace}}</span>
                    {% endif %}
                  {%endif%}
                  
                  {# 성별 #}
                  {% if r.h_sex == '암' %}
                  <span style="font-size: 1.2rem; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {% elif r.h_sex == '거' %}
                  <span style="font-size: 1.2rem; color:var(--color-r3); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {%else%}
                  <span style="font-size: 1.2rem; color:var(--color-light-gray); border-radius: 10px; background-color:var(--color-bg); padding: 1px 2px;">{{r.h_sex}}</span>
                  {%endif%}
                  
                  {# 나이 #}
                  {% if r.h_age >= 5.9 %}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-r1); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {% elif r.h_age < 3 %}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-r2); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {%else%}
                  <span style="font-family: Arial; font-size: 1.1rem; font-style: italic; color:var(--color-gray); border-radius: 10px; background-color:var(--color-bg); padding:1px 3px">{{r.h_age}}</span>
                  {%endif%}

                {% endif %}
              </div>
              
            </td>

            {# 마체중 #}
            <td style="font-family: Arial; font-size: 1.3rem ">
              
              <div style="text-align:center">

                {# 경주마 체중 증감 #}
                {% if r.r_rank %}
                <span style="font-family: Arial; color:var(--color-gray);">{{r.h_weight|slice:"0:3"}}㎏</span>
                {% else %}
                  {% if r.h_weight|slice:"0:3" <= '440' %}
                  <span style="font-family: Arial; color:var(--color-r5);">{{r.h_weight|slice:"0:3"}}㎏</span>
                  {% elif r.h_weight|slice:"0:3" >= '500' %}
                  <span style="font-family: Arial; color:var(--color-r2);">{{r.h_weight|slice:"0:3"}}㎏</span>
                  {% else %}
                  <span style="font-family: Arial; color:var(--color-gray);">{{r.h_weight|slice:"0:3"}}㎏</span>
                  {% endif %}
                {% endif %}
                
              </div>

              {% if r.h_weight|slice:"4:" %}
                {% if r.h_weight|slice:"4:5" == '+' %}
                <div style="text-align:right; font-style: italic; font-size: 1.2rem;  color:var(--color-r5);">
                  <span style="font-family: Arial;">{{r.h_weight|slice:"4:"}}</span>
                </div>
                {% else %}
                <div style="text-align:right; font-style: italic; font-size: 1.2rem;  color:var(--color-r1);">
                  <span style="font-family: Arial;">{{r.h_weight|slice:"4:"}}</span>
                </div>
                {% endif %}
              {% endif %}

            </td>

            {# 부담중량 #}
            <td style="font-family: Arial; font-size: 1.3rem ">

              <div>
                {# 부담중량 #}
                {% if r.handycap == compare_r.handycap__max %}
                <div style="font-family: Arial; text-align: center; color:var(--color-r1);">{{r.handycap}}&nbsp;</div>
                {% else %}
                <div style="font-family: Arial; text-align: center; color:var(--color-light-gray);">{{r.handycap}}&nbsp;</div>
                {% endif %}

                {# 부담중량 증감 #}
                {% if r.i_prehandy == 0.0 %}
                  <div style="font-family: Arial; font-style: italic; font-size: 1.2rem; color: var(--color-gray); text-align: right;">-&nbsp;&nbsp;</div>
                {% else %}
                  {% if r.handycap|sub:r.i_prehandy > 0 %}
                    <div style="font-family: Arial; font-style: italic; font-size: 1.2rem; color: var(--color-r5); text-align: right;">+{{r.handycap|sub:r.i_prehandy}}</div>
                  {% elif r.handycap|sub:r.i_prehandy == 0 %}
                    <div style="font-family: Arial; font-style: italic; font-size: 1.2rem; color: var(--color-gray); text-align: right;">-&nbsp;&nbsp;</div>
                  {% else %}
                    <div style="font-family: Arial; font-style: italic; font-size: 1.2rem; color: var(--color-r1); text-align: right;">{{r.handycap|sub:r.i_prehandy}}</div>
                  {% endif %}
                {% endif %}
              </div>
              
            </td>

            {# 기수 조교사 #}
            <td align="center">

              {% if r.jockey_old %}   {# 기수변경 #}
              <div style="font-style: italic; font-size: 1.2rem; text-align: left; ">
                <span class="tooltip" style="color:var(--color-r2);">{{r.jockey}}
                  <span class="tooltip-text">
                    🐴 변경사유 : {{r.reason}}{% if r.jockey_old%}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;변경전 기수 : {{r.jockey_old}}{% endif %}
                  </span>
                </span>

              </div>
              {% else %}
              <div style="font-size: 1.2rem; text-align: left;">
                {{r.jockey}}
                
              </div>
              
              {% endif %}
            
              {% if r.trainer in trainer_double_check %}
              <div style="font-size: 1.2rem; text-align: right; color:var(--color-r3)">
                {% for jockey, cnt in training_cnt %}
                  {% if r.jockey == jockey %}
                  <span style="font-family: Arial; font-size: 1.2rem; text-align: right; color:var(--color-r1); border-radius: 7px; background-color: var(--color-bg); padding:1px 2px;">{{cnt}}</span>
                  {% endif %}
                {% endfor %}
                {{r.trainer}}
              </div>
              {% else %}
              <div style="color: var(--color-gray); font-size: 1.2rem; text-align: right;">
                {% for jockey, cnt in training_cnt %}
                  {% if r.jockey == jockey %}
                  <span style="font-family: Arial; font-size: 1.2rem; text-align: right; color:var(--color-r1); border-radius: 7px; background-color: var(--color-bg); padding:1px 2px;">{{cnt}}</span>
                  {% endif %}
                {% endfor %}
                {{r.trainer}}
              </div>
              {% endif %}

              

            </td>

            {# 복승률 #}
            <td align="right" style="font-size: 1.3rem ">

              {% if r.jockey_old %}
              <div style="font-family: Arial; font-size: 1.2rem; color:var(--color-r1); text-decoration:line-through;">{{r.j_per}}</div>
              {% else %}
                {% if r.j_per %}
                  {% if compare_r.j_per__max == r.j_per %}
                  <div style="font-family: Arial; font-size: 1.2rem; color:var(--color-r1);">{{r.j_per}}</div>
                  {%else%}
                  <div style="font-family: Arial; font-size: 1.2rem;">{{r.j_per}}</div>
                  {%endif%}
                {% endif %}
              {% endif %}

              {% if r.t_per %}
                {% if compare_r.t_per__max == r.t_per %}
                <div style="color:var(--color-r1); font-family: Arial; font-size: 1.2rem;">{{r.t_per}}</div>
                {%else%}
                <div style="color: var(--color-gray); font-family: Arial; font-size: 1.2rem;">{{r.t_per}}</div>
                {%endif%}
              {% endif %}
            </td>

            {# 기수 조교사 연대율 #}
            <td align="right">

              {% if r.jockey_old %}
                {# 기수가 변경되었으면 기존 기수의 기록을 삭제 #}
                {% if r.jt_cnt %}
                <div style="font-size: 1.2rem;">
                  {% if r.jt_per > r.j_per and r.jt_per > r.t_per %}
                  <span style="font-family: Arial; color: var(--color-r1); text-decoration:line-through;">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                  {% elif r.jt_per > r.j_per and r.jt_per <= r.t_per %} <span style="font-family: Arial; color: var(--color-r4); text-decoration:line-through;">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color:var(--color-gray); text-decoration:line-through;">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                    {% endif %}
                    <span style="color:var(--color-gray); font-size:1.1rem; text-decoration:line-through;">%</span>
                </div>
                {% endif %}
                
                {# 기수 조교사 연대 출주 복승 회수 #}
                <div style="font-size: 1.0rem; color:gray; text-align: right;">
                  <span class="tooltip" style="font-family: Arial; color:var(--color-light-gray)">
                    <span style="font-family: Arial; color:var(--color-r1);">{{r.jt_1st}}</span>
                    <span style="font-family: Arial; color:var(--color-r2);">{{r.jt_2nd|sub:r.jt_1st}}</span>
                    <span style="font-family: Arial; color:var(--color-r3);">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                    <span class="tooltip-text" style="font-family: Arial; font-size: 1.1rem;">
                      <div style="font-family: Arial; color:var(--color-main)">복승률 : {{r.jt_per}}</div>
                      <div style="font-family: Arial; color:var(--color-main)">최근 1년 출주 횟수 : {{r.jt_cnt}}</div>
                    </span>
                  </span>
                
                  <!-- <span style="font-family: Arial; color:var(--color-gray)">/</span>
                                    <span style="font-family: Arial; color:var(--color-r3)">{{r.jt_cnt}}</span> -->
                </div>
              {% else %}
                {% if r.jt_cnt %}
                  <div style="font-size: 1.2rem;">
                    {% if r.jt_per > r.j_per and r.jt_per > r.t_per %}
                    <span style="font-family: Arial; color: var(--color-r1);">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                    {% elif r.jt_per > r.j_per and r.jt_per <= r.t_per %} 
                    <span style="font-family: Arial; color: var(--color-r4);">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-light-gray);">{{r.jt_3rd|mul:100|div:r.jt_cnt|floatformat:"1"}}</span>
                    {% endif %}
                    <span style="color:var(--color-gray); font-size:1.1rem;">%</span>
                  </div>
                  <!-- <div style="font-size: 1.2rem;">
                    {% if r.jt_per > r.j_per and r.jt_per > r.t_per %}
                    <span style="font-family: Arial; color: var(--color-r1);">{{r.jt_per|rjust:"5"}}</span>
                    {% elif r.jt_per > r.j_per and r.jt_per <= r.t_per %} 
                    <span style="font-family: Arial; color: var(--color-r4);">{{r.jt_per|rjust:"5"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color:var(--color-gray);">{{r.jt_per|rjust:"5"}}</span>
                    {% endif %}
                    <span style="color:var(--color-gray); font-size:1.1rem;">%</span>
                  </div> -->
                {% endif %}
              
                {# 기수 조교사 연대 출주 복승 회수 #}
                <div style="font-size: 1.0rem; color:gray; text-align: right;">
                  <span class="tooltip" style="font-family: Arial; color:var(--color-light-gray)">
                    <span style="font-family: Arial; color:var(--color-r1)">{{r.jt_1st}}</span>
                    <span style="font-family: Arial; color:var(--color-r2)">{{r.jt_2nd|sub:r.jt_1st}}</span>
                    <span style="font-family: Arial; color:var(--color-r3)">{{r.jt_3rd|sub:r.jt_2nd}}</span>
                    <span class="tooltip-text" style="font-family: Arial; font-size: 1.1rem;">
                      <div style="font-family: Arial; color:var(--color-main)">복승률 : {{r.jt_per}}</div>
                      <div style="font-family: Arial; color:var(--color-main)">최근 1년 출주 횟수 : {{r.jt_cnt}}</div>
                    </span>
                  </span>

                  <!-- <span style="font-family: Arial; color:var(--color-gray)">/</span>
                  <span style="font-family: Arial; color:var(--color-r3)">{{r.jt_cnt}}</span> -->
                </div>
            {% endif %}
            </td>
            
            {# 경주전개 furlong 기록 #}
            <td align="center" style="font-size: 1.3rem ">
              {% if compare_r.i_s1f__min == r.i_s1f %}
              <div style="font-family: Arial; color:var(--color-r1); font-weight: 500;">{{r.cs1f}}</div>
              {% elif r.i_s1f|sub:7 < compare_r.i_s1f__min %}
              <span style="font-family: Arial; color:var(--color-r2); font-weight: 500;">{{r.cs1f}}</span>
              {% else %}
              <div style="font-family: Arial; color:var(--color-light-gray);">{{r.cs1f}}</div>
              {% endif %}

              {% if r.s1f_rank %}
                {% if compare_r.s1f_rank__min == r.s1f_rank %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-r1); font-weight: 600;">{{r.s1f_rank}}</div>
                {% else %}
                <div style="font-family: Arial; text-align: right; font-size: 1.05rem; color:var(--color-gray);">
                  
                  {% if r.s1f_rank >= 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">{{r.s1f_rank}}</span>
                  {% elif r.s1f_rank >= 3 and r.s1f_rank < 6 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r2);">{{r.s1f_rank}}</span>
                  {% elif r.s1f_rank > 0 and r.s1f_rank < 3 %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-r1);">{{r.s1f_rank}}</span>
                  {% else %}
                  <span style="font-size: 1.05rem; font-family: Arial; color:var(--color-gray);">-</span>
                  {% endif %}
                
                </div>
                {% endif %}
                
              {% endif %}

            </td>
            <td align="center" style="font-size: 1.3rem ">
              {% if compare_r.i_g3f__min == r.i_g3f %}
              <span style="font-family: Arial; color:var(--color-r1); font-weight: 500;">{{r.cg3f}}</span>
              {% elif r.i_g3f|sub:7 < compare_r.i_g3f__min %}
              <span style="font-family: Arial; color:var(--color-r2); font-weight: 500;">{{r.cg3f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cg3f}}</span>
              {% endif %}

            </td>
            <td align="center" style="font-size: 1.3rem ">
              {% if compare_r.i_g2f__min == r.i_g2f %}
              <span style="font-family: Arial; color:var(--color-r1); font-weight: 500;">{{r.cg2f}}</span>
              {% elif r.i_g2f|sub:7 < compare_r.i_g2f__min %} 
              <span style="font-family: Arial; color:var(--color-r2); font-weight: 500;">{{r.cg2f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cg2f}}</span>
              {% endif %}
            </td>
            <td align="center" style="font-size: 1.3rem ">

              {% if compare_r.i_g1f__min == r.i_g1f %}
              <span style="font-family: Arial; color:var(--color-r1); font-weight: 500;">{{r.cg1f}}</span>
              {% elif r.i_g1f|sub:7 < compare_r.i_g1f__min %}
              <span style="font-family: Arial; color:var(--color-r2); font-weight: 500;">{{r.cg1f}}</span>
              {% else %}
              <span style="font-family: Arial; color:var(--color-light-gray);">{{r.cg1f}}</span>
              {% endif %}
              
            </td>

            {# 프로그램 예상기록 / 경주거리 최근3경주 환산기록 #}
            <td align="center">
              
              <div style=" font-size: 1.3rem;">
                
                {% if compare_r.recent3__min == r.recent3 %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}</span>
                {% else %}

                  {% if r.recent3 < r.complex5 %}
                  <span style="font-family: Arial; color:var(--color-r3); font-style: italic;">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}</span>
                  {% else %}
                    {% if r.recent3 < r.convert_r and r.recent3 < r.recent5 %}
                    <span style="font-family: Arial; color: var(--color-light-gray);">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.recent3|slice:"0:1"}}&nbsp;{{r.recent3|slice:"1:6"}}</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>
              
            </td>

            {# 최근 7경주 환산기록 #}
            <td align="center">
              
              <div style=" font-size: 1.3rem;">

                {% if compare_r.recent5__min == r.recent5 %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                {% else %}
                  {% if r.recent5 < r.complex5 %}
                  <span style="font-family: Arial; color:var(--color-r3); font-style: italic;">{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                  {% else %}
                    {% if r.recent5 < r.convert_r and r.recent5 < r.recent3 %}
                    <span style="font-family: Arial; color: var(--color-light-gray);">{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.recent5|slice:"0:1"}}&nbsp;{{r.recent5|slice:"1:6"}}</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>

            </td>

            {# 전체경주 환산기록 / 경주기록 #}
            <td>
              <div style=" font-size: 1.3rem;">
                {% if compare_r.convert_r__min == r.convert_r %}
                <span style="font-family: Arial; color: var(--color-r1); font-style: italic;">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                {% else %}

                  {% if r.convert_r < r.complex5 %}
                  <span style="font-family: Arial; color:var(--color-r3); font-style: italic;">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                  {% else %}
                    {% if r.convert_r < r.recent5 and r.convert_r < r.recent3 %}
                    <span style="font-family: Arial; color: var(--color-light-gray);">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                    {% else %}
                    <span style="font-family: Arial; color: var(--color-gray);">{{r.convert_r|slice:"0:1"}}&nbsp;{{r.convert_r|slice:"1:6"}}</span>
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>
              
            </td>

            {# 인기도 최근7경주 #}
            <td align="center" style="font-family: Arial; font-size: 1.3rem;">
              
              {% if r.remark|slice:"0:1" == '1' and r.remark|slice:"1:2" == '-' %}
              <div style="font-size: 1.0rem; color:var(--color-r1);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
              {% elif r.remark|slice:"0:1" == '2' and r.remark|slice:"1:2" == '-' %}
              <div style="font-size: 1.0rem; color:var(--color-r2);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
              {% elif r.remark|slice:"0:1" == '3' and r.remark|slice:"1:2" == '-' %}
              <div style="font-size: 1.0rem; color:var(--color-r3);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
              {% else %}
              <div style="font-size: 1.0rem; color:var(--color-main);">{{r.remark|slice:"0:9"}}<br>{{r.remark|slice:"9:"}}</div>
              {% endif %}

            </td>

            {# 인기도 or 연식 #}
            <td align="right" style="font-family: Arial; font-size: 1.3rem;">
              
              {% if r.h_weight|length > 3 %}

              <div style="font-size: 1.2rem; text-align: right; font-style: normal;">
                {% if r.r_rank == 1 %}
                <span style="color:var(--color-r1); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 2 %}
                <span style="color:var(--color-r2); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 3 %}
                <span style="color:var(--color-r3); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 4 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% elif r.r_rank == 5 %}
                <span style="color:var(--color-gray); font-family: Arial;">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% else %}
                <span style="font-family: Arial; color: var(--color-gray);">{% if r.alloc3r %} {{r.alloc3r}} {% endif %}</span>
                {% endif %}

                {% if request.user.username == 'admin' %}
                  {% if r.bet == '1' %}
                  <span style="font-size:1.0rem;">🥇</span>
                  {% elif r.bet == '2' %}
                  <span style="font-size:1.0rem;">🥈</span>
                  {% elif r.bet == '3' %}
                  <span style="font-size:1.0rem;">🥉</span>
                  {% elif r.bet == '4' %}
                  <span style="font-size:1.0rem;">❔</span>
                  {% else %}
                  <span style=" font-size:1.0rem; font-family: Arial; color:var(--color-gray);"></span>
                  {% endif %}
                {% endif %}
              </div>
              <div>
                <progress value={{r.r_pop}} max="99" style="width: 3.0rem"></progress>
              </div>

              {% else %}
              <div>
                <progress value={{r.r_pop}} max="99" style="width: 3.0rem"></progress>
                
              </div>
              
              <div style="text-align: right; font-size:1.1rem; color:var(--color-light-gray);">
                {% if r.r_pop >= 90 %}
                <span style="font-family: Arial; color:var(--color-r1); border-radius: 7px; background-color:white; padding: 0px 2px;">{{r.r_pop}}</span>
                {% elif r.r_pop >= 60 and r.r_pop < 90 %}
                <span style="font-family: Arial; color:var(--color-r2);">{{r.r_pop}}</span>
                {% elif r.r_pop >= 20  and r.r_pop < 60 %}
                <span style="font-family: Arial; color:var(--color-light-gray);">{{r.r_pop}}</span>
                {% elif r.r_pop >= 1  and r.r_pop < 20 %}
                <span style="font-family: Arial; color:var(--color-gray);">{{r.r_pop}}</span>
                {% else %}
                <span style=" font-family: Arial; color:var(--color-gray);">-</span>
                {% endif %} 

                {% if request.user.username == 'admin' %}
                  {% if r.bet == '1' %}
                  <span style="font-size:1.0rem; font-family: Arial; color:var(--color-r1); border-radius: 7px; background-color:var(--color-bg); padding: 0px 2px;">축</span>
                  {% elif r.bet == '2' %}
                  <span style="font-size:1.0rem; font-family: Arial; color:var(--color-light); border-radius: 7px; background-color:var(--color-bg); padding: 0px 2px;">복</span>
                  {% elif r.bet == '3' %}
                  <span style="font-size:1.0rem; font-family: Arial; color:var(--color-light-gray); border-radius: 7px; background-color:var(--color-bg); padding: 0px 2px;">연</span>
                  {% elif r.bet == '4' %}
                  <span style="font-size:1.0rem; font-family: Arial; color:var(--color-gray);  border-radius: 7px; background-color:var(--color-bg); padding: 0px 2px;">?</span>
                  {% else %}
                  <span style=" font-size:1.0rem; font-family: Arial; color:var(--color-gray);"></span>
                  {% endif %}
                {% endif %}
              </div>
              {% endif %}

            </td>

            {# 예상 / 실순 #}
            <td align="center" style="font-family: Arial; font-size: 1.3rem; color: var(--color-main-light);">
              <div style="font-family: Arial;">
                {% if r.rank > 20 %}
                <span style="font-family: Arial; font-size:0.9rem; font-weight: 700; font-style: italic; color:var(--color-r1); text-align: center;">🐣</span>
                {% else %} 
                  {% if r.rank == 1 %}
                  <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r1); text-align: center;">{{r.rank}}</div>
                  {% elif r.rank == 2 %}
                  <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r2); text-align: center;">{{r.rank}}</div>
                  {% elif r.rank == 3 %}
                  <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r3); text-align: center;">{{r.rank}}</div>
                  {% elif r.rank == 4 %}
                  <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r4); text-align: center;">{{r.rank}}</div>
                  {% elif r.rank == 5 %}
                  <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r5); text-align: center;">{{r.rank}}</div>
                  {% else %}
                  <div style="font-family: Arial; font-size:1.2rem; font-style: italic; color:var(--color-gray); text-align: center;">{{r.rank}}</div>
                  {% endif %}
                {% endif %}
              </div>

              {% if r.r_rank %}
                
                {% if r.r_rank == 1 %}
                <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r1); text-align: right;">{{r.r_rank}}</div>
                {% elif r.r_rank == 2 %}
                <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r2); text-align: right;">{{r.r_rank}}</div>
                {% elif r.r_rank == 3 %}
                <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r3); text-align: right;">{{r.r_rank}}</div>
                {% elif r.r_rank == 4 %}
                <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r4); text-align: right;">{{r.r_rank}}</div>
                {% elif r.r_rank == 5 %}
                <div style="font-family: Arial; font-size:1.2rem; font-weight: 700; font-style: italic; color:var(--color-r5); text-align: right;">{{r.r_rank}}</div>
                {% elif r.r_rank == 99 %}
                <div style="font-family: Arial; font-size:.9rem; font-weight: 700; color:var(--color-gray); text-align: right;">🚫</div>
                {% else %}
                <div style="font-family: Arial; font-size:1.2rem; font-style: italic; color:var(--color-gray); text-align: right;">{{r.r_rank}}</div>
                {% endif %}
              {% endif %}

            </td>

          </tr>

          <tr class="fold">
            <td colspan="17">
              <div class="fold-content">
                <span style="font-size: 1.2rem; color:var(--color-light-gray);">🩸 해외 사이트를 통한 무분별한 데이터 크롤링 문제로 Login 후에만 참조 가능합니다.</span>
              </div>
            </td>
          </tr>
          {% endfor %}
      
      
        </tbody>
      </table>

    </div>
    <!-- Room End -->

    <script>
      $(document).ready(function () {

        $('ul.tabs li').click(function () {
          var tab_id = $(this).attr('data-tab');

          $('ul.tabs li').removeClass('current');
          $('.tab-content').removeClass('current');

          $(this).addClass('current');
          $("#" + tab_id).addClass('current');
        })
      })
    </script>

    <!-- <div class="roomListRoom"> -->
    <div class="activities" style="background-color: var(--color-bg);">

      <div class="room__top">
        
        <div class="room__topLeft">

          <nav class="header__menu">
          
            <!-- Logged In -->
            {% if request.user.is_authenticated %}
            <div class="header__user">
              <a href="{% url 'update-user' %}">
                <div class="avatar avatar--small active">
                  <img src="{% static request.user.avatar.url %}" />
                </div>
                <p style="font-size: 1.35rem;">{% if request.user.name %}{{request.user.name}}{% else %} 필명등록 {%endif%}
                  <span style="font-size: xx-small;">@{{request.user.last_login}}</span>
                </p>
              </a>
              
            </div>
            {% else %}
          
            <!-- Not Logged In -->
            <a href="{% url 'login' %}">
              <div class="avatar avatar--small active">
              <img src="{% static 'images/avatar.svg' %}" />
              </div>
              <p>Login</p>
            </a>
            {% endif %}
          </nav>
          
          
        </div>

        <div class="room__topRight">
          {% if request.user.username == 'admin' %}
          <a href="{% url 'update_changed_race' r_condition.rcity r_condition.rdate r_condition.rno %}" onclick="window.open(this.href, '_blank', 'width=900, height=800, toolbars=no, scrollbars=yes'); return false;">
            <span class="tooltip" style="font-size: 1.35rem; font-weight: 400;">🔏
              <span class="tooltip-text" style="position:fixed ; text-align: center; width: 150px; z-index: 111;">인기도 & 경주제반 입력</span></span>
          </a>
          {% endif %}
        </div>
      </div>

      <hr style="border: solid 1px black;">
      
      <a class="btn btn--main btn--pill" style="font-size: 1.2rem; border-radius: 7px; background-color: var(--color-bg); border-color: var(--color-dark);"
        href="{% url 'race_related' r_condition.rcity r_condition.rdate r_condition.rno %}"
        onclick="window.open(this.href, 'w_related', 'width=1000, height=880, toolbars=no, scrollbars=yes'); return false;">기수 & 마방 & 마주</a>
      <hr style="border: solid 1px black;">
      
      <table class="fold-table" style="table-layout: fixed; border-radius: 7px;">
        <thead>
    
          <tr>
            <th rowspan="2"><span class="visible-big" style="padding:0.17rem;">&nbsp;<br>마번<br>&nbsp;</span></th>
            <th width="39%" rowspan="1"><span class="visible-big">부마</span></th>
            <th width="45%" colspan="3"><span class="visible-big">연승률 & 총전적</span></th>
          </tr>
    
          <tr>
            <th width="28%" rowspan="1"><span class="visible-big">거래가(천원)</span></th>
            <th colspan="3"><span class="visible-big" style="color:var(--color-r4);">{{r_condition.distance}}ᴹ 연승률</span></th>
          </tr>
    
        </thead>
        <tbody>
          {% for gate, rank, horse, paternal, rd1, rd2, rd3, rdtot, r1, r2, r3, rtot, price, tot_prize in paternal %}
          <tr class="view">
    
            <td>
              <div align="center" style="font-family: Arial; font-size:1.4rem;">
                {% if rank == 1 %}
                <span style="font-style: italic; color:var(--color-r1); font-weight: 700;">
                  {{gate}}
                </span>
                {% elif rank == 2 %}
                <span style="font-style: italic; color:var(--color-r2); font-weight: 700;">
                  {{gate}}
                </span>
                {% elif rank == 3 %}
                <span style="font-style: italic; color:var(--color-r3); font-weight: 700;">
                  {{gate}}
                </span>
                {% elif rank == 4 %}
                <span style="font-style: italic; color:var(--color-r4); font-weight: 700;">
                  {{gate}}
                </span>
                {% elif rank == 5 %}
                <span style="font-style: italic; color:var(--color-r5); font-weight: 700;">
                  {{gate}}
                </span>
                {% else %}
                <span style="font-style: normal;">
                  {{gate}}
                </span>
                {% endif %}
    
              </div>
            </td>
    
            <td>
              <div>
                {% if paternal|length >= 8 %}
                <p style="font-family: Arial; font-size:1.0rem;">{{paternal|slice:"0:12"}}</p>
                {%else%}
                <p style="font-family: Arial; font-size:1.2rem;">{{paternal|slice:"0:8"}}</p>
                {%endif%}
              </div>
    
              <div>
                {% if price >= 50000 %}
                <p style="text-align: right; font-family: Arial; font-size:1.15rem; color:var(--color-r1)">{{price|floatformat:0|intcomma}}&nbsp;</p>
                {% elif price >= 20000 and price < 50000 %} <p style="text-align: right; font-family: Arial; font-size:1.1rem; color:var(--color-r3)">{{price|floatformat:0|intcomma}}&nbsp;</p>
                  {% elif price > 0 and price < 20000 %} <p style="text-align: right; font-family: Arial; font-size:1.1rem; color:var(--color-gray)">{{price|floatformat:0|intcomma}}&nbsp;</p>
                    {% else %}
                    <p style="text-align: right; font-family: Arial; font-size:1.1rem;">-&nbsp;</p>
                    {% endif %}
              </div>
    
            </td>
    
            <td>
    
              {% if rtot != 0 %}
              {% if r1|add:r2|add:r3|div:rtot|mul:100|floatformat:1 >= '30.0' %}
              <div align="right" style="font-family: Arial; font-size:1.3rem; color:rgb(0, 192, 255); width:700;">{{r1|add:r2|add:r3|div:rtot|mul:100|floatformat:1}}</div>
              {% else %}
              <div align="right" style="font-family: Arial; font-size:1.3rem;">{{r1|add:r2|add:r3|div:rtot|mul:100|floatformat:1}}</div>
              {% endif %}
              {% else %}
              <div align="right" style="font-family: Arial; font-size:1.3rem;">0.0</div>
              {%endif%}
    
              {% if rdtot != 0 %}
              {% if rd1|add:rd2|add:rd3|div:rdtot|mul:100|floatformat:1 >= r1|add:r2|add:r3|div:rtot|mul:100|floatformat:1 %}
              <div align="right" style="font-family: Arial; font-size:1.2rem; color:var(--color-r1); width:700;">{{rd1|add:rd2|add:rd3|div:rdtot|mul:100|floatformat:1}}</div>
              {% else %}
              <div align="right" style="font-family: Arial; font-size:1.2rem;">{{rd1|add:rd2|add:rd3|div:rdtot|mul:100|floatformat:1}}</div>
              {% endif %}
              {% else %}
              <div align="right" style="font-family: Arial; font-size:1.2rem;">0.0</div>
              {%endif%}
    
    
            </td>
    
            <td>
              <div align="right" style="font-family: Arial; font-size:1.2rem;">{{rtot}}</div>
              <div align="right" style="font-family: Arial; font-size:1.2rem;">{{rdtot}}</div>
            </td>
            <td>
              <div align="right" style="font-family: Arial; font-size:1.2rem;">{{r1|add:r2|add:r3}}</div>
              <div align="right" style="font-family: Arial; font-size:1.2rem;">{{rd1|add:rd2|add:rd3}}</div>
            </td>
    
    
          </tr>
    
          <tr class="fold">
            <td colspan="5">
              <div class="fold-content">
                <span style="font-size: 1.2rem; color:var(--color-light-gray);">🩸 해외 사이트를 통한 무분별한 데이터 크롤링 문제로 <br> Login 후에만 참조 가능합니다.</span>
              </div>
            </td>
          </tr>
    
          {% endfor %}
    
        </tbody>
      </table>

    </div>
    <!-- Activity End -->


  </div>

  {% include 'footer.html' %}

  <script>
    $(function () {
      $(".fold-table tr.view").on("click", function () {
        if ($(this).hasClass("open")) {
          $(this).removeClass("open").next(".fold").removeClass("open");
        } else {
          $(".fold-table tr.view").removeClass("open").next(".fold").removeClass("open");
          $(this).addClass("open").next(".fold").addClass("open");
        }
      });
    });

  </script>
  
  <script>
    $(document).ready(function () {

      $('ul.tabs1 li').click(function () {
        var tab_id = $(this).attr('data-tab');

        $('ul.tabs1 li').removeClass('current');
        $('.tab-content1').removeClass('current');

        $(this).addClass('current');
        $("#" + tab_id).addClass('current');
      })

    })
  </script>

  <script>
    $(window).on('load', function () {
      $('.loader').fadeOut();
    });
  </script>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W5HDZ7Z" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

</main>
{% endblock %}