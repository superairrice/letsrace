<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" type="image/x-icon" href="{% static '/images/number-9.png' %}" />

  <link rel="stylesheet" href="{% static 'styles/style.css' %}" />
  <link rel="stylesheet" href="{% static 'styles/styles.css' %}" />

  <script src="{% static 'js/script.js' %}"></script>

  <script src="{% static 'js/jquery-3.6.1.js' %}"></script>

  <title>Race Update</title>
  <style>
    .rbn-actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-top: 0.9rem;
      flex-wrap: wrap;
    }

    .rbn-actions-left {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .rbn-close {
      margin-left: auto;
      display: flex;
      justify-content: flex-end;
      margin-top: 1rem;
    }
  </style>

</head>

{% block content %}
<br>

<div class="container">

  {% if messages %}
  <div style="margin-bottom: 0.8rem;">
    {% for message in messages %}
    <div style="font-size:1.2rem; padding:0.6rem 0.8rem; border-radius:0.5rem; margin-bottom:0.4rem; border:1px solid #c6d2df; background:#f2f7fc; color:#2f4a66;">
      {{ message }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- <form class="header__search" method="GET" action="{% url 'race_breakingnews' %}"> -->
  <form class="header__search" action="" method="POST">
    {% csrf_token %}
    <label>
      <fieldset align="center" style="width: 15rem;">
        <input type="radio" style="font-size:1.2rem; width:1.2rem; height:1.2rem; border:1px;" name="rcity" value="ì„œìš¸" {% if rcity == "ì„œìš¸" %} checked {% endif %} checked>&nbsp;ì„œìš¸
        &nbsp;
        <input type="radio" style="font-size:1.2rem; width:1.2rem; height:1.2rem; border:1px;" name="rcity" value="ë¶€ì‚°" {% if rcity == "ë¶€ì‚°" %} checked {% endif %}>&nbsp;ë¶€ì‚°
      </fieldset>

      &nbsp;&nbsp;

      <input style="width: 12rem; font-size: 1.3rem;" type="date" value={{fdate}} name="fdate" >

      <span style="font-size: 1.3rem;">&nbsp;&nbsp;&nbsp;ê²½ì£¼ë²ˆí˜¸:&nbsp;</span>
      <input style="text-align: center; width: 5.0rem; border-style: outset; font-size: 1.2rem;" type="number" min="1" max="99" step="1" value={{rno}} name="rno" >

      <span style="font-size: 1.3rem;">&nbsp;&nbsp;&nbsp;ì¶œì£¼ë‘ìˆ˜:&nbsp;</span>
      <input style="text-align: center; width: 5.0rem; border-style: outset; font-size: 1.2rem;" type="number" min="1" max="99" step="1" value={{rcount}} name="rcount" >

      <span style="font-size: 1.3rem;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“š&nbsp;ë°ì´í„°:&nbsp;</span>

      <select name="fdata" style="font-size:1.2rem; padding: 0.2rem;">
        <option value="-" {% if fdata == '-' %} selected {% endif %}>ì„ íƒ</option>
        
        <option value="ì¶œì „í‘œë³€ê²½" {% if fdata == 'ì¶œì „í‘œë³€ê²½' %} selected {% endif %}>ì¶œì „í‘œë³€ê²½</option>
        <option value="ë§ˆì²´ì¤‘" {% if fdata == 'ë§ˆì²´ì¤‘' %} selected {% endif %}>ë§ˆì²´ì¤‘</option>
        <option value="ê²½ì£¼ìˆœìœ„" {% if fdata == 'ê²½ì£¼ìˆœìœ„' %} selected {% endif %}>ê²½ì£¼ìˆœìœ„</option>
        <!-- <option value="ê²½ì£¼ë§ˆì·¨ì†Œ" {% if fdata == 'ê²½ì£¼ë§ˆì·¨ì†Œ' %} selected {% endif %}>ê²½ì£¼ë§ˆì·¨ì†Œ</option>
        <option value="ê¸°ìˆ˜ë³€ê²½" {% if fdata == 'ê¸°ìˆ˜ë³€ê²½' %} selected {% endif %}>ê¸°ìˆ˜ë³€ê²½</option> -->
        <option value="ìˆ˜ì˜ì¡°êµ" {% if fdata == 'ìˆ˜ì˜ì¡°êµ' %} selected {% endif %}>ìˆ˜ì˜ì¡°êµ</option>
        <option value="ë§ì§„ë£Œí˜„í™©" {% if fdata == 'ë§ì§„ë£Œí˜„í™©' %} selected {% endif %}>ë§ì§„ë£Œí˜„í™©</option>
        <option value="ì¶œì „ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜" {% if fdata == 'ì¶œì „ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜' %} selected {% endif %}>ì¶œì „ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜</option>
        <option value="ì‹¬íŒìœ„ì› Report" {% if fdata == 'ì‹¬íŒìœ„ì› Report' %} selected {% endif %}>ì‹¬íŒìœ„ì› Report</option>
        <option value="ì¶œë°œì‹¬ì‚¬(b4)" {% if fdata == 'ì¶œë°œì‹¬ì‚¬(b4)' %} selected {% endif %}>ì¶œë°œì‹¬ì‚¬(b4)</option>
        <option value="ì¶œë°œì¡°êµ(b5)" {% if fdata == 'ì¶œë°œì¡°êµ(b5)' %} selected {% endif %}>ì¶œë°œì¡°êµ(b5)</option>

      </select>
    </label>
    
    <textarea name="r_content" rows="30" style="font-size: 1.2rem; position:relative; width: 100%; padding: 10px">{{ r_content|default_if_none:"" }}</textarea>

    <div class="rbn-actions">
      <div class="rbn-actions-left">
        <button class="btn btn--link" type="submit" name="action" value="crawl_kra" style="font-size: 1.3rem;">ë§ˆì‚¬íšŒ ì¶œì „í‘œë³€ê²½ í¬ë¡¤ë§</button>
        <button class="btn btn--link" type="submit" name="action" value="convert" style="font-size: 1.3rem;">Convert</button>
      </div>
    </div>

    {% if crawl_source %}
    <div style="margin-top: 0.8rem; font-size: 1.2rem; color: #39516a;">
      source: <a href="{{ crawl_source }}" target="_blank" rel="noopener">{{ crawl_source }}</a>
      &nbsp;|&nbsp;rows: {{ result_cnt }}
    </div>
    {% endif %}

    {% if crawl_rows %}
    <div style="margin-top: 1.2rem; max-height: 28rem; overflow: auto; border: 1px solid #c6d2df; border-radius: 0.6rem;">
      <table style="width:100%; border-collapse: collapse; font-size: 1.15rem;">
        <thead>
          <tr style="background:#eef4fb;">
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">êµ¬ë¶„</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ê²½ì£¼</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ì¶œë²ˆ</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ë§ˆëª…</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ë³€ê²½ì „</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ë³€ê²½í›„</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ë¶€ì¤‘</th>
            <th style="padding:0.5rem; border-bottom:1px solid #c6d2df;">ì‚¬ìœ </th>
          </tr>
        </thead>
        <tbody>
          {% for row in crawl_rows %}
          <tr>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef;">{{ row.type }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef; text-align:center;">{{ row.rno }}R</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef; text-align:center;">{{ row.gate }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef;">{{ row.horse }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef;">{{ row.jockey_old }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef;">{{ row.jockey_new }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef; text-align:center;">{{ row.handycap }}</td>
            <td style="padding:0.45rem; border-bottom:1px solid #e0e7ef;">{{ row.reason }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}

    <div class="rbn-close">
      <a class="btn btn--dark" onclick="window.close()">Close</a>
    </div>

  </form>


</div>



{% endblock content %}
