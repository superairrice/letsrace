{% load humanize %}
{% load mathfilters %}

<style>
  /* 원래 내장된 tooltip 텍스트는 숨기고, 포탈로만 표시 */
  .tooltip .tooltip-text { display: none !important; }
  /* 포탈 기본 스타일 (JS에서 position과 좌표만 제어) */
  .tooltip-portal {
    position: fixed;
    z-index: 99999;
    max-width: 40rem;
    background: rgba(18, 18, 18, 0.96);
    color: var(--color-light-gray);
    padding: 8px 10px;
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 8px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    pointer-events: none;
    font-size: 1.1rem;
    line-height: 1.35;
  }
</style>

<div class="roomListRoom" style="height:max-content; border-radius: 7px; padding: 0px; margin: 0px;">
  <style>
    /* home_left_sub2와 동일한 은은한 교차 배경 + 일관된 호버 */
    tr.alt-row-odd td { background-color: rgba(255,255,255,0.03); transition: background-color .18s ease; }
    tr.alt-row-even td { background-color: rgba(0,0,0,0.06);  transition: background-color .18s ease; }
    tr.alt-row-odd:hover td { background-color: rgba(255,255,255,0.06); }
    tr.alt-row-even:hover td { background-color: rgba(0,0,0,0.12); }
    tr.alt-row-odd:hover, tr.alt-row-even:hover { filter: brightness(1.06); }
  </style>

  <ul class="tabs">
    {% if rdays.0.0 %}<li class="tab-link {% if rdays.0.0  == rdays.0.2 or rflag == False %}current{% endif %}" data-tab="tab-1" style="padding: 6px 25px; border-radius: 4px;">
      <span style="font-family: Arial, Helvetica, sans-serif;">{{rdays.0.0|slice:"4:6"}}.{{rdays.0.0|slice:"6:8"}}({{rdays.0.1}})</span></li>{% endif %}
    {% if rdays.1.0 %}<li class="tab-link {% if rdays.1.0  == rdays.1.2 %}current{% endif %}" data-tab="tab-2" style="padding: 6px 25px; border-radius: 4px;">
      <span style="font-family: Arial, Helvetica, sans-serif;">{{rdays.1.0|slice:"4:6"}}.{{rdays.1.0|slice:"6:8"}}({{rdays.1.1}})</span></li>{% endif %}
    {% if rdays.2.0 %}<li class="tab-link {% if rdays.2.0  == rdays.2.2 %}current{% endif %}" data-tab="tab-3" style="padding: 6px 25px; border-radius: 4px;">
      <span style="font-family: Arial, Helvetica, sans-serif;">{{rdays.2.0|slice:"4:6"}}.{{rdays.2.0|slice:"6:8"}}({{rdays.2.1}})</span></li>{% endif %}
    {% if rdays.3.0 %}<li class="tab-link {% if rdays.3.0  == rdays.3.2 %}current{% endif %}" data-tab="tab-4" style="padding: 6px 25px; border-radius: 4px;">
      <span style="font-family: Arial, Helvetica, sans-serif;">{{rdays.3.0|slice:"4:6"}}.{{rdays.3.0|slice:"6:8"}}({{rdays.3.1}})</span></li>{% endif %} {# 월요일 경마 에외처리 20231009 only #}

    <li class="tab-link" data-tab="tab-5" style="padding: 4px 25px; border-radius: 4px;">
      서울<sup style="font-size: 1.2rem; color: var(--color-r2);">&nbsp;R</sup>
    </li>
    <li class="tab-link" data-tab="tab-6" style="padding: 4px 25px; border-radius: 4px;">
      부산<sup style="font-size: 1.2rem; color: var(--color-r2);">&nbsp;R</sup>
    </li>
  </ul>

  <div id="tab-1" class="tab-content {% if rdays.0.0  == rdays.0.2 or rflag == False %}current{% endif %}"> {# 경마일 당일 이거나 비경마일이면 current tab #}

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">

        {% include 'base/home_left_sub1.html' %}
        
        {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
        {% if r_rday == rdays.0.1 %}

          {% include 'base/home_left_sub2.html' %}

        {% endif %}
        {% endfor %}
    
        <tr>
          <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;

          </td>

        </tr>

    </table>

  </div>

  <div id="tab-2" class="tab-content {% if rdays.1.0  == rdays.0.2 %}current{% endif %}">

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">
    
      {% include 'base/home_left_sub1.html' %}

      {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
      {% if r_rday == rdays.1.1 %}

        {% include 'base/home_left_sub2.html' %}
    
      {% endif %}
      {% endfor %}
    
      <tr>
        <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;</td>
      </tr>
    
    </table>
    
        
  </div>

  <div id="tab-3" class="tab-content {% if rdays.2.0  == rdays.0.2 %}current{% endif %}" >

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">
    
      {% include 'base/home_left_sub1.html' %}

      {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
      {% if r_rday == rdays.2.1 %}
      
        {% include 'base/home_left_sub2.html' %}

      {% endif %}
      {% endfor %}
    
      <tr>
        <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;</td>
      </tr>
    
    </table>
    
  </div>

  <div id="tab-4" class="tab-content {% if rdays.3.0  == rdays.0.2 %}current{% endif %}">

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">
    
      {% include 'base/home_left_sub1.html' %}

      {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
      {% if r_rday == rdays.3.1 %}
        {% include 'base/home_left_sub2.html' %}
    
      {% endif %}
      {% endfor %}
    
      <tr>
        <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;</td>
      </tr>
    
    </table>
    
  </div>
  <div id="tab-5" class="tab-content">

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">
    
      {% include 'base/home_left_sub1.html' %}

      {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
      {% if r_rcity == '서울' %}
        {% include 'base/home_left_sub3.html' %}
    
      {% endif %}
      {% endfor %}
    
      <tr>
        <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;</td>
      </tr>
    
    </table>
    
  </div>
  <div id="tab-6" class="tab-content">

    <table class="rwd-table" style="background-color: var(--color-dark); border-style: double;">
    
      {% include 'base/home_left_sub1.html' %}

      {% for r_rcity, r_rdate, r_rday, r_rno, rtime, distance, r2alloc, r333alloc, r123alloc, grade, dividing, r1award, r_overview, r_guide in race %}
      {% if r_rcity != '서울' %}
        {% include 'base/home_left_sub3.html' %}
    
      {% endif %}
      {% endfor %}
    
      <tr>
        <td colspan="31" align="center" style="font-size:6.3rem; text-transform:capitalize; border-top: 1px solid gray; background-color: var(--color-bg);">&nbsp;</td>
      </tr>
    
    </table>
    
  </div>

</div>

<script>
  $(function () {
    $(".fold-table tr.view").on("click", function () {
      if ($(this).hasClass("open")) {
        $(this).removeClass("open").next(".fold").removeClass("open");
      } else {
        $(".fold-table tr.view").removeClass("open").next(".fold").removeClass("open");
        $(this).addClass("open").next(".fold").addClass("open");
      }
    });
  });

</script>

<script>
  $(document).ready(function () {

    $('ul.tabs li').click(function () {
      var tab_id = $(this).attr('data-tab');

      $('ul.tabs li').removeClass('current');
      $('.tab-content').removeClass('current');

      $(this).addClass('current');
      $("#" + tab_id).addClass('current');
    })

  })
</script>
